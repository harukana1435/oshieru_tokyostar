(()=>{var e={};e.id=356,e.ids=[356],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9793:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>h,originalPathname:()=>x,pages:()=>d,routeModule:()=>u,tree:()=>c});var a=s(8090),r=s(9409),n=s(1522),l=s.n(n),i=s(1305),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let c=["",{children:["(authenticated)",{children:["transactions",{children:["swipe",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,51)),"/Users/h-okano/Dev/softbank_hackason/apps/web/app/(authenticated)/transactions/swipe/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,4110)),"/Users/h-okano/Dev/softbank_hackason/apps/web/app/(authenticated)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,111,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,87)),"/Users/h-okano/Dev/softbank_hackason/apps/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,111,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/h-okano/Dev/softbank_hackason/apps/web/app/(authenticated)/transactions/swipe/page.tsx"],x="/(authenticated)/transactions/swipe/page",h={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(authenticated)/transactions/swipe/page",pathname:"/transactions/swipe",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},6355:(e,t,s)=>{Promise.resolve().then(s.bind(s,865))},865:(e,t,s)=>{"use strict";s.r(t),s.d(t,{SwipeTransactionContent:()=>u});var a=s(4297),r=s(5803),n=s(3776),l=s(1275),i=s(4209),o=s(7728),c=s(99);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,s(2858).Z)("Hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0",key:"aigmz7"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v2",key:"1n6bmn"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v8",key:"a9iiix"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]);var x=s(2927);function h({onBack:e,onUpdate:t}){let[s,n]=(0,r.useState)([]),[h,u]=(0,r.useState)(0),[m,p]=(0,r.useState)(!0),[g,f]=(0,r.useState)(!1),[b,j]=(0,r.useState)({x:0,y:0}),[v,y]=(0,r.useState)(null),[N,w]=(0,r.useState)({x:0,y:0}),[k,_]=(0,r.useState)(!1),[S,M]=(0,r.useState)(!1),[P,$]=(0,r.useState)(null),Z=(0,r.useRef)(null);(0,r.useEffect)(()=>{A()},[]);let A=async()=>{try{let e=await fetch("https://oshieru-api.harukana1435.workers.dev/dashboard/pending-transactions",{headers:{Authorization:`Bearer ${localStorage.getItem("sessionId")}`,"X-User-Email":localStorage.getItem("userEmail")||""}});if(e.ok){let t=await e.json();if(t.success){let e=t.data.map(e=>({...e,eventAt:new Date(e.eventAt),createdAt:new Date(e.createdAt)}));n(e)}}}catch(e){console.error("Failed to load pending transactions:",e)}finally{p(!1)}},D=()=>{f(!1),j({x:0,y:0}),y(null),M(!1),$(null)},C=async e=>{if(h>=s.length||k)return;let a=s[h],r="right"===e?"goods":"other",n="right"===e?"oshi":"life";M(!0),$(e),_(!0);try{(await fetch(`https://oshieru-api.harukana1435.workers.dev/transactions/${a.id}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("sessionId")}`,"X-User-Email":localStorage.getItem("userEmail")||""},body:JSON.stringify({purpose:r,accountId:`acc_${n}_${a.accountId.split("_")[2]}`})})).ok?setTimeout(()=>{u(e=>e+1),D(),_(!1),t&&t()},1500):(console.error("Failed to update transaction"),D(),_(!1))}catch(e){console.error("Error updating transaction:",e),D(),_(!1)}},q=()=>{g&&!k&&(Math.abs(b.x)>120?C(b.x>0?"right":"left"):D())};if(m)return a.jsx("div",{className:"flex items-center justify-center py-12",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"振り分け未完了取引を読み込み中..."})]})});if(h>=s.length)return a.jsx("div",{className:"text-center py-12",children:a.jsx(l.Zb,{className:"max-w-md mx-auto",children:(0,a.jsxs)(l.aY,{className:"p-8",children:[a.jsx("h2",{className:"text-3xl font-bold text-green-600",children:"振り分け完了！"}),(0,a.jsxs)("p",{className:"text-muted-foreground mt-4 mb-8",children:["すべての取引の振り分けが完了しました。",a.jsx("br",{}),"ダッシュボードで結果を確認してください。"]}),a.jsx(i.z,{onClick:e,className:"bg-green-500 hover:bg-green-600 text-white px-8 py-3",children:"ダッシュボードに戻る"})]})})});let z=s[h],E=s.length-h;return(0,a.jsxs)("div",{className:"space-y-8 max-w-2xl mx-auto p-4",children:[a.jsx("div",{className:"md:hidden fixed top-4 left-4 z-50",children:(0,a.jsxs)(i.z,{onClick:e,variant:"outline",className:"flex items-center gap-2 bg-white shadow-lg",children:[a.jsx(c.Z,{className:"w-4 h-4"}),"戻る"]})}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[a.jsx(d,{className:"w-7 h-7 text-blue-600"}),"スワイプで振り分け"]}),a.jsx("p",{className:"text-muted-foreground mt-1",children:k?(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),"処理中..."]}):`残り ${E} 件の取引を振り分けします`})]}),(0,a.jsxs)(i.z,{onClick:e,variant:"outline",className:"hidden md:flex items-center gap-2",children:[a.jsx(c.Z,{className:"w-4 h-4"}),"戻る"]})]}),(0,a.jsxs)("div",{className:"w-full mb-32",children:[a.jsx("div",{className:"bg-gray-200 rounded-full h-3 shadow-inner",children:a.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-3 rounded-full transition-all duration-500 shadow-sm",style:{width:`${h/s.length*100}%`}})}),a.jsx("div",{className:"text-center mt-6",children:(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[h," / ",s.length," 完了"]})})]}),a.jsx("div",{className:"flex justify-center mt-8",children:(0,a.jsxs)("div",{className:"relative w-full max-w-md",children:[h+1<s.length&&a.jsx(l.Zb,{className:"absolute inset-0 transform scale-95 opacity-30 z-0 bg-gray-50",children:a.jsx(l.aY,{className:"p-6",children:a.jsx("div",{className:"text-center",children:a.jsx("div",{className:"text-gray-400 text-sm",children:"次の取引"})})})}),(0,a.jsxs)(l.Zb,{ref:Z,className:`relative z-10 transform transition-transform duration-200 ${"left"===v?"bg-green-50 border-green-200":"right"===v?"bg-purple-50 border-purple-200":"bg-white"}`,style:{transform:`translate(${b.x}px, ${b.y}px) rotate(${b.x/10}deg)`,cursor:g?"grabbing":"grab"},onTouchStart:e=>{if(k)return;f(!0);let t=e.touches[0];w({x:t.clientX,y:t.clientY})},onTouchMove:e=>{if(!g||k)return;let t=e.touches[0],s=t.clientX-N.x;j({x:s,y:t.clientY-N.y}),Math.abs(s)>50?y(s>0?"right":"left"):y(null)},onTouchEnd:()=>{g&&!k&&(Math.abs(b.x)>120?C(b.x>0?"right":"left"):D())},onMouseDown:e=>{k||(f(!0),w({x:e.clientX,y:e.clientY}))},onMouseMove:g?e=>{if(!g||k)return;let t=e.clientX-N.x;j({x:t,y:e.clientY-N.y}),Math.abs(t)>50?y(t>0?"right":"left"):y(null)}:void 0,onMouseUp:q,onMouseLeave:q,children:[a.jsx(l.Ol,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx(l.ll,{className:"text-lg font-bold text-gray-900",children:z.memo||z.originalDescription}),a.jsx(l.SZ,{className:"text-sm text-gray-600 mt-1",children:(0,o.o0)(z.eventAt)})]}),a.jsx("div",{className:"text-right",children:(0,a.jsxs)("div",{className:`text-2xl font-bold ${"out"===z.sign?"text-red-600":"text-green-600"}`,children:["out"===z.sign?"-":"+",(0,o.xG)(z.amount)]})})]})}),a.jsx(l.aY,{className:"pt-0",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:[a.jsx("strong",{children:"取引内容:"})," ",z.originalDescription]}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border-2 border-dashed border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[a.jsx(c.Z,{className:"w-4 h-4"}),a.jsx("span",{className:"font-medium",children:"生活口座"})]}),a.jsx("div",{className:"text-gray-500 font-medium",children:"スワイプで選択"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-purple-600",children:[a.jsx("span",{className:"font-medium",children:"推し活口座"}),a.jsx(x.Z,{className:"w-4 h-4"})]})]})}),v&&a.jsx("div",{className:`text-center py-2 rounded-lg font-medium ${"left"===v?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"}`,children:"left"===v?"← 生活口座に振り分け":"推し活口座に振り分け →"})]})})]}),S&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-20 bg-white/90 rounded-lg",children:(0,a.jsxs)("div",{className:`text-center ${"left"===P?"text-green-600":"text-purple-600"}`,children:[a.jsx("div",{className:"text-4xl mb-2",children:"left"===P?"✓":"\uD83D\uDC9C"}),a.jsx("div",{className:"font-bold text-lg",children:"left"===P?"生活口座":"推し活口座"}),a.jsx("div",{className:"text-sm",children:"振り分け完了"})]})})]})}),(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-medium mb-2",children:[a.jsx(d,{className:"w-5 h-5"}),a.jsx("span",{children:"操作方法"})]}),(0,a.jsxs)("div",{className:"text-sm text-blue-600 space-y-1",children:[(0,a.jsxs)("p",{children:["• カードを",a.jsx("strong",{children:"左にスワイプ"}),"で生活口座"]}),(0,a.jsxs)("p",{children:["• カードを",a.jsx("strong",{children:"右にスワイプ"}),"で推し活口座"]}),a.jsx("p",{children:"• または下のボタンでも操作できます"})]})]}),(0,a.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-100",children:[a.jsx("p",{className:"text-center text-gray-600 mb-4 font-medium",children:"または、ボタンで操作することもできます"}),(0,a.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,a.jsxs)("button",{onClick:()=>C("left"),className:`px-8 py-3 rounded-2xl font-semibold transition-all duration-300 ${k?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-green-500 to-green-600 text-white shadow-lg shadow-green-500/30 hover:shadow-xl hover:shadow-green-500/40 hover:scale-105 active:scale-95"} flex items-center gap-3`,disabled:k,children:[a.jsx(c.Z,{className:"w-5 h-5"}),"生活口座"]}),(0,a.jsxs)("button",{onClick:()=>C("right"),className:`px-8 py-3 rounded-2xl font-semibold transition-all duration-300 ${k?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-purple-500 to-purple-600 text-white shadow-lg shadow-purple-500/30 hover:shadow-xl hover:shadow-purple-500/40 hover:scale-105 active:scale-95"} flex items-center gap-3`,disabled:k,children:["推し活口座",a.jsx(x.Z,{className:"w-5 h-5"})]})]})]})]})]})}function u(){let e=(0,n.useRouter)();return a.jsx(h,{onBack:()=>{e.push("/transactions")},onUpdate:()=>{e.refresh()}})}},99:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2858).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},2927:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2858).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},51:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var a=s(1002),r=s(7460);let n=(0,r.createProxy)(String.raw`/Users/h-okano/Dev/softbank_hackason/apps/web/app/(authenticated)/transactions/swipe/swipe-transaction-content.tsx`),{__esModule:l,$$typeof:i}=n;n.default;let o=(0,r.createProxy)(String.raw`/Users/h-okano/Dev/softbank_hackason/apps/web/app/(authenticated)/transactions/swipe/swipe-transaction-content.tsx#SwipeTransactionContent`);function c(){return a.jsx(o,{})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[79,94,570,703],()=>s(9793));module.exports=a})();