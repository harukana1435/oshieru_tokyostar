(()=>{var e={};e.id=598,e.ids=[598],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9609:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>d,routeModule:()=>h,tree:()=>o});var a=t(8090),r=t(9409),l=t(1522),n=t.n(l),c=t(1305),i={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>c[e]);t.d(s,i);let o=["",{children:["(authenticated)",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,9354)),"/Users/h-okano/Dev/softbank_hackason/apps/web/app/(authenticated)/dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,4110)),"/Users/h-okano/Dev/softbank_hackason/apps/web/app/(authenticated)/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,111,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,87)),"/Users/h-okano/Dev/softbank_hackason/apps/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,111,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/h-okano/Dev/softbank_hackason/apps/web/app/(authenticated)/dashboard/page.tsx"],x="/(authenticated)/dashboard/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(authenticated)/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},5307:(e,s,t)=>{Promise.resolve().then(t.bind(t,1104))},1104:(e,s,t)=>{"use strict";t.r(s),t.d(s,{DashboardContent:()=>k});var a=t(4297),r=t(5803),l=t(3776),n=t(4209),c=t(7728),i=t(1275);function o({account:e,transactions:s,onClose:t}){let r=s.filter(s=>{if(s.accountId&&e.id){let t=s.accountId===e.id;return t&&console.log(`Transaction ${s.id} matched by accountId: ${s.accountId} === ${e.id}`),t}if(s.accountKind){let t=s.accountKind===e.kind;return t&&console.log(`Transaction ${s.id} matched by accountKind: ${s.accountKind} === ${e.kind}`),t}let t="life"===e.kind&&"ticket"!==s.purpose&&"goods"!==s.purpose&&"event"!==s.purpose||"oshi"===e.kind&&("ticket"===s.purpose||"goods"===s.purpose||"event"===s.purpose);return t&&console.log(`Transaction ${s.id} matched by purpose fallback: purpose=${s.purpose}, account.kind=${e.kind}`),t});console.log(`AccountDetailsModal: Found ${r.length} transactions for account ${e.name} (${e.kind})`),console.log("Account ID:",e.id),console.log("All transactions count:",s.length);let l=r.filter(e=>"in"===e.sign).reduce((e,s)=>e+s.amount,0),o=r.filter(e=>"out"===e.sign).reduce((e,s)=>e+s.amount,0);return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(i.Zb,{className:"w-full max-w-4xl max-h-[90vh] flex flex-col bg-white shadow-2xl",children:[a.jsx(i.Ol,{className:"flex-shrink-0 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-purple-50",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(i.ll,{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:["life"===e.kind?"\uD83D\uDCB0":"✨"," ",e.name,"詳細"]}),(0,a.jsxs)(i.SZ,{className:"text-lg font-semibold text-blue-600 mt-1",children:["残高: ",(0,c.xG)(e.balanceCached)]})]}),a.jsx(n.z,{variant:"ghost",onClick:t,className:"hover:bg-white/80 rounded-full w-10 h-10 p-0",children:a.jsx("span",{className:"text-xl text-gray-500 hover:text-gray-700",children:"✕"})})]})}),(0,a.jsxs)(i.aY,{className:"flex-1 overflow-y-auto p-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"p-6 bg-gradient-to-br from-green-50 to-emerald-100 rounded-xl border border-green-200 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-2xl",children:"\uD83D\uDCC8"}),a.jsx("p",{className:"text-sm font-medium text-green-700",children:"総収入"})]}),a.jsx("p",{className:"text-2xl font-bold text-green-800",children:(0,c.xG)(l)})]}),(0,a.jsxs)("div",{className:"p-6 bg-gradient-to-br from-red-50 to-rose-100 rounded-xl border border-red-200 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-2xl",children:"\uD83D\uDCC9"}),a.jsx("p",{className:"text-sm font-medium text-red-700",children:"総支出"})]}),a.jsx("p",{className:"text-2xl font-bold text-red-800",children:(0,c.xG)(o)})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx("span",{className:"text-xl",children:"\uD83D\uDCCB"}),a.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"取引履歴"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:[r.length,"件"]})]}),a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:0===r.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[a.jsx("span",{className:"text-4xl mb-4 block",children:"\uD83D\uDCED"}),a.jsx("p",{className:"text-gray-500 font-medium",children:"取引履歴がありません"})]}):r.sort((e,s)=>new Date(s.eventAt).getTime()-new Date(e.eventAt).getTime()).map(e=>a.jsx("div",{className:`p-4 rounded-xl border transition-all hover:shadow-md ${e.isPending?"bg-gradient-to-r from-yellow-50 to-amber-50 border-yellow-300 shadow-sm":e.isAutoCategorized?"bg-gradient-to-r from-green-50 to-emerald-50 border-green-300 shadow-sm":"bg-gradient-to-r from-gray-50 to-slate-50 border-gray-200"}`,children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("p",{className:"font-medium",children:e.memo}),e.isAutoCategorized&&a.jsx("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded-full",children:"自動分類"}),e.isPending&&a.jsx("span",{className:"text-xs px-2 py-1 bg-yellow-100 text-yellow-700 rounded-full",children:"保留中"})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,c.o0)(e.eventAt)," • ",e.purpose]})]}),a.jsx("div",{className:"text-right",children:(0,a.jsxs)("p",{className:`font-medium ${"out"===e.sign?"text-red-600":"text-green-600"}`,children:["out"===e.sign?"-":"+",(0,c.xG)(e.amount)]})})]})},e.id))})]})]})]})})}let d=[{value:"salary",label:"給与・収入"},{value:"ticket",label:"チケット"},{value:"goods",label:"グッズ"},{value:"event",label:"イベント"},{value:"food",label:"食費"},{value:"rent",label:"家賃・住居費"},{value:"utilities",label:"光熱費・通信費"},{value:"transport",label:"交通費"},{value:"other",label:"その他"}],x=[{value:"life",label:"生活口座"},{value:"oshi",label:"推し活口座"}];function m({transaction:e,onSave:s,onClose:t}){let[l,o]=(0,r.useState)({...e}),[m,h]=(0,r.useState)(["ticket","goods","event"].includes(e.purpose)?"oshi":"life");(0,r.useEffect)(()=>{o({...e}),e.accountKind?h(e.accountKind):h(["ticket","goods","event"].includes(e.purpose)?"oshi":"life")},[e]);let u=async()=>{let a=l.purpose;"oshi"!==m||["ticket","goods","event"].includes(a)||(a="other");try{let r=await fetch(`https://oshieru-api.harukana1435.workers.dev/transactions/${e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("sessionId")}`,"X-User-Email":localStorage.getItem("userEmail")||""},body:JSON.stringify({purpose:a,memo:l.memo,accountType:m})});if(r.ok){let e=await r.json();console.log("Transaction updated via API:",e);let a={...e.transaction,eventAt:new Date(e.transaction.eventAt),createdAt:new Date(e.transaction.createdAt),isAutoCategorized:!1,isPending:!1};s(a),t()}else console.error("Failed to update transaction:",await r.text()),alert("取引の更新に失敗しました")}catch(e){console.error("Error updating transaction:",e),alert("取引の更新中にエラーが発生しました")}};return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(i.Zb,{className:"w-full max-w-md",children:[a.jsx(i.Ol,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx(i.ll,{children:"取引を編集"}),(0,a.jsxs)(i.SZ,{children:[(0,c.xG)(e.amount)," • ",e.eventAt.toLocaleDateString("ja-JP")]})]}),a.jsx(n.z,{variant:"ghost",onClick:t,children:"✕"})]})}),(0,a.jsxs)(i.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"元の摘要"}),a.jsx("p",{className:"p-2 bg-gray-50 rounded text-sm",children:e.originalDescription||e.memo})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"メモ"}),a.jsx("input",{type:"text",value:l.memo,onChange:e=>o({...l,memo:e.target.value}),className:"w-full p-2 border rounded mt-1",placeholder:"メモを入力"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"口座種別"}),a.jsx("select",{value:m,onChange:e=>h(e.target.value),className:"w-full p-2 border rounded mt-1",children:x.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"用途"}),a.jsx("select",{value:l.purpose,onChange:e=>o({...l,purpose:e.target.value}),className:"w-full p-2 border rounded mt-1",children:d.filter(e=>"oshi"===m?["ticket","goods","event","other"].includes(e.value):!["ticket","goods","event"].includes(e.value)).map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]}),a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-blue-700",children:[a.jsx("strong",{children:"編集後:"})," ","life"===m?"生活口座":"推し活口座"," • ",d.find(e=>e.value===l.purpose)?.label]})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(n.z,{variant:"outline",onClick:t,className:"flex-1",children:"キャンセル"}),a.jsx(n.z,{onClick:u,className:"flex-1",children:"保存"})]})]})]})})}var h=t(6545),u=t(2858);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let g=(0,u.Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),p=(0,u.Z)("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),b=(0,u.Z)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),f=(0,u.Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var j=t(360),v=t(7119),N=t(8227),y=t(5041),w=t(2927);function k(){let[e,s]=(0,r.useState)(null),[t,i]=(0,r.useState)(!0),[d,x]=(0,r.useState)(null),[u,k]=(0,r.useState)(null),[S,A]=(0,r.useState)(null),[D,C]=(0,r.useState)(!1),[I,P]=(0,r.useState)(!1),[T,$]=(0,r.useState)(""),[E,z]=(0,r.useState)(!1),[_,G]=(0,r.useState)(!1),O=(0,l.useRouter)();(0,r.useEffect)(()=>{(async()=>{try{i(!0);let e=localStorage.getItem("currentUser");if(!e){O.push("/login");return}let t=JSON.parse(e),a="https://oshieru-api.harukana1435.workers.dev",r=localStorage.getItem("sessionId");console.log("Dashboard API request details:",{userId:t.id,userEmail:t.email,sessionId:r,apiUrl:a});let l=t.email||localStorage.getItem("userEmail")||"customer1@oshieru.com",n=await fetch(`${a}/dashboard`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`,"X-User-Email":l},body:JSON.stringify({userId:t.id})});if(!n.ok)throw Error("Failed to fetch dashboard data");let c=await n.json();if(c.success){let e=c.data.accounts||[],t=c.data.recentTransactions||[],a={user:c.data.user,accounts:e,totalBalance:e.reduce((e,s)=>e+(s.balanceCached||0),0),lifeAccount:e.find(e=>"life"===e.kind),oshiAccount:e.find(e=>"oshi"===e.kind),latestScore:c.data.latestScore,recentTransactions:t.map(e=>({...e,eventAt:new Date(e.eventAt),createdAt:new Date(e.createdAt),accountKind:e.accountKind||(e.accountId?.includes("life")?"life":"oshi"),accountName:e.accountName||(e.accountId?.includes("life")?"生活口座":"推し活口座")})),rewards:c.data.rewards||[],transactionCount:t.length},r=a.recentTransactions.filter(e=>"life"===e.accountKind),l=a.recentTransactions.filter(e=>"oshi"===e.accountKind),n=0;r.length>0&&(n=r.reduce((e,s)=>e+("in"===s.sign?s.amount:-s.amount),0));let i=0;l.length>0&&(i=l.reduce((e,s)=>e+("in"===s.sign?s.amount:-s.amount),0)),a.lifeBalance=n,a.oshiBalance=i,a.totalBalance=n+i,s(a)}else x(c.message||"データの取得に失敗しました")}catch(e){console.error("Dashboard fetch error:",e),x("ネットワークエラーが発生しました")}finally{i(!1)}})()},[O]),(0,r.useEffect)(()=>{e&&e.oshiAccount&&e.oshiAccount.balanceCached<0&&P(!0)},[e]),(0,r.useEffect)(()=>{I&&e?.oshiAccount?.balanceCached<0&&$((Math.abs(e.oshiAccount.balanceCached)+1e4).toString())},[I,e]);let Z=async()=>{try{C(!0);let s=parseFloat(T);if(!s||s<=0){alert("正しい金額を入力してください");return}if(!e.lifeAccount||e.lifeAccount.balanceCached<s){alert("生活口座の残高が不足しています");return}let t=localStorage.getItem("currentUser");if(!t)return;let a=JSON.parse(t),r="https://oshieru-api.harukana1435.workers.dev",l=localStorage.getItem("sessionId"),n=a.email||localStorage.getItem("userEmail")||"customer1@oshieru.com",c={accountId:e.lifeAccount.id,amount:s,sign:"out",purpose:"fund_transfer",memo:`資金移動 → 推し活口座 (￥${s.toLocaleString()})`,eventAt:new Date().toISOString()},i={accountId:e.oshiAccount.id,amount:s,sign:"in",purpose:"fund_transfer",memo:`資金移動 ← 生活口座 (￥${s.toLocaleString()})`,eventAt:new Date().toISOString()},o=await fetch(`${r}/transactions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`,"X-User-Email":n},body:JSON.stringify(c)}),d=await fetch(`${r}/transactions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`,"X-User-Email":n},body:JSON.stringify(i)});o.ok&&d.ok?window.location.reload():alert("振替処理に失敗しました")}catch(e){console.error("Balance transfer error:",e),alert("振替処理中にエラーが発生しました")}finally{C(!1),P(!1),$("")}},q=async e=>{try{C(!0);let e=localStorage.getItem("currentUser");if(!e)return;let t=JSON.parse(e),a=localStorage.getItem("sessionId"),r=t.email||localStorage.getItem("userEmail")||"customer1@oshieru.com",l=await fetch("https://oshieru-api.harukana1435.workers.dev/dashboard",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`,"X-User-Email":r},body:JSON.stringify({userId:t.id})});if(l.ok){let e=await l.json();if(e.success){let t=e.data.accounts||[],a=e.data.recentTransactions||[],r={user:e.data.user,accounts:t,totalBalance:t.reduce((e,s)=>e+(s.balanceCached||0),0),lifeAccount:t.find(e=>"life"===e.kind),oshiAccount:t.find(e=>"oshi"===e.kind),latestScore:e.data.latestScore,recentTransactions:a.map(e=>({...e,eventAt:new Date(e.eventAt),createdAt:new Date(e.createdAt),accountKind:e.accountKind||(e.accountId?.includes("life")?"life":"oshi"),accountName:e.accountName||(e.accountId?.includes("life")?"生活口座":"推し活口座")})),rewards:e.data.rewards||[],transactionCount:a.length};s(r)}}}catch(e){console.error("Transaction update error:",e)}finally{C(!1)}};return t?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx(h.g,{})}):d?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-red-600 mb-4",children:d}),a.jsx(n.z,{onClick:()=>window.location.reload(),children:"再試行"})]})}):e?(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl border border-gray-200/50 shadow-xl shadow-black/5",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-r from-green-500 to-blue-500 rounded-full",children:a.jsx(g,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"推し活安心度スコア"}),a.jsx("p",{className:"text-sm text-gray-600",children:"健康的な推し活の指標"})]})]}),a.jsx("button",{onClick:()=>z(!E),className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors",children:a.jsx(p,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row items-center gap-8",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(({score:e,size:s=120})=>{let t=(s-20)/2,r=2*Math.PI*t*.75,l=r-r*e/100;return(0,a.jsxs)("div",{className:"relative inline-flex items-center justify-center",children:[(0,a.jsxs)("svg",{width:s,height:s,className:"transform -rotate-45",children:[a.jsx("circle",{cx:s/2,cy:s/2,r:t,fill:"none",stroke:"#e5e7eb",strokeWidth:"8",strokeDasharray:r,strokeDashoffset:"0",strokeLinecap:"round"}),a.jsx("circle",{cx:s/2,cy:s/2,r:t,fill:"none",stroke:e>=80?"#10b981":e>=60?"#f59e0b":e>=40?"#ef4444":"#6b7280",strokeWidth:"8",strokeDasharray:r,strokeDashoffset:l,strokeLinecap:"round",className:"transition-all duration-1000 ease-out"})]}),(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:e}),a.jsx("div",{className:"text-xs text-gray-500",children:"点"})]})]})},{score:e.latestScore?.score||0})}),(0,a.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"評価レベル"}),a.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:e.latestScore?.label||"評価中"})]}),e.latestScore?.factors&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("button",{onClick:()=>G(!_),className:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-800 transition-colors",children:["詳細を表示",_?a.jsx(b,{className:"w-4 h-4"}):a.jsx(f,{className:"w-4 h-4"})]}),_&&(0,a.jsxs)("div",{className:"space-y-4 p-4 bg-gray-50/80 rounded-lg",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4 p-3 bg-white rounded-lg border",children:[(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"月収"}),a.jsx("p",{className:"text-lg font-bold text-gray-900",children:e.latestScore?.analysisData?.income?(0,c.xG)(e.latestScore.analysisData.income):"---"})]}),(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"推し活費用"}),a.jsx("p",{className:"text-lg font-bold text-purple-600",children:e.latestScore?.analysisData?.oshiExpense?(0,c.xG)(e.latestScore.analysisData.oshiExpense):"---"})]}),(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"生活必需品費用"}),a.jsx("p",{className:"text-lg font-bold text-green-600",children:e.latestScore?.analysisData?.essentialExpense?(0,c.xG)(e.latestScore.analysisData.essentialExpense):"---"})]}),(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"余剰金"}),a.jsx("p",{className:"text-lg font-bold text-blue-600",children:e.latestScore?.analysisData?.income&&e.latestScore?.analysisData?.essentialExpense?(0,c.xG)(e.latestScore.analysisData.income-e.latestScore.analysisData.essentialExpense):"---"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:"スコア内訳"}),(0,a.jsxs)("div",{className:"p-3 bg-white rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"収入比率スコア"}),(0,a.jsxs)("span",{className:"text-sm font-bold text-gray-900",children:[e.latestScore?.breakdown?.incomeRatioScore||0,"点 / 40点"]})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:["推し活費の割合: ",e.latestScore?.factors?.incomeRatio?`${Math.round(100*e.latestScore.factors.incomeRatio)}%`:"---",a.jsx("br",{}),a.jsx("span",{className:"text-gray-500",children:"(20%以下: 40点, 21-30%: 30点, 31-40%: 20点, 41%以上: 10点)"})]})]}),(0,a.jsxs)("div",{className:"p-3 bg-white rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"余剰金スコア"}),(0,a.jsxs)("span",{className:"text-sm font-bold text-gray-900",children:[e.latestScore?.breakdown?.surplusScore||0,"点 / 30点"]})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:["余剰金比率: ",e.latestScore?.factors?.surplusRatio?`${Math.round(100*e.latestScore.factors.surplusRatio)}%`:"---",a.jsx("br",{}),a.jsx("span",{className:"text-gray-500",children:"(100%以下: 30点, 101-120%: 20点, 121-150%: 10点, 150%超: 0点)"})]})]}),(0,a.jsxs)("div",{className:"p-3 bg-white rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"推奨額適合スコア"}),(0,a.jsxs)("span",{className:"text-sm font-bold text-gray-900",children:[e.latestScore?.breakdown?.recommendedAmountScore||0,"点 / 30点"]})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:["推奨額: ",e.latestScore?.analysisData?.recommendedAmount?(0,c.xG)(e.latestScore.analysisData.recommendedAmount):"---",a.jsx("br",{}),"乖離率: ",e.latestScore?.factors?.recommendedDeviation?`${Math.round(e.latestScore.factors.recommendedDeviation)}%`:"---",a.jsx("br",{}),a.jsx("span",{className:"text-gray-500",children:"(+10%以下: 30点, +10-20%: 20点, +20-50%: 10点, +50%超: 0点)"})]})]})]})]})]})]})]}),E&&(0,a.jsxs)("div",{className:"mt-6 p-4 bg-blue-50/80 rounded-lg border border-blue-200",children:[a.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"スコアについて"}),(0,a.jsxs)("div",{className:"text-sm text-blue-800 space-y-1",children:[(0,a.jsxs)("p",{children:["• ",a.jsx("strong",{children:"80点以上"}),": 非常に健全な推し活状況"]}),(0,a.jsxs)("p",{children:["• ",a.jsx("strong",{children:"60-79点"}),": 良好な推し活状況"]}),(0,a.jsxs)("p",{children:["• ",a.jsx("strong",{children:"40-59点"}),": 注意が必要な状況"]}),(0,a.jsxs)("p",{children:["• ",a.jsx("strong",{children:"40点未満"}),": 改善が必要な状況"]})]})]})]})}),a.jsx("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl border border-gray-200/50 shadow-xl shadow-black/5",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full",children:a.jsx(j.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"総残高"}),a.jsx("p",{className:"text-sm text-gray-600",children:"全口座の合計金額"})]})]}),a.jsx("button",{onClick:()=>O.push("/transactions"),className:"px-4 py-2 text-sm text-gray-600 bg-gray-50 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200 rounded-xl border border-gray-200/50",children:"取引履歴を見る"})]}),a.jsx("div",{className:"text-center",children:a.jsx("div",{className:"text-4xl font-bold text-gray-900",children:(0,c.xG)(e.totalBalance||0)})})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsx("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl border border-gray-200/50 shadow-xl shadow-black/5",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-r from-green-500 to-green-600 rounded-full",children:a.jsx(v.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"生活口座"}),a.jsx("p",{className:"text-sm text-gray-600",children:"日常生活に必要な資金"})]})]}),a.jsx("button",{onClick:()=>A({...e.lifeAccount,transactions:e.recentTransactions.filter(e=>"life"===e.accountKind)}),className:"px-4 py-2 text-sm text-gray-600 bg-gray-50 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200 rounded-xl border border-gray-200/50",children:"詳細を見る"})]}),a.jsx("div",{className:"text-center mb-4",children:a.jsx("div",{className:"text-3xl font-bold text-gray-900",children:(0,c.xG)(e.lifeAccount?.balanceCached||0)})}),(0,a.jsxs)("div",{className:"text-center text-sm text-gray-600",children:["取引件数: ",e.recentTransactions.filter(e=>"life"===e.accountKind&&!e.isPending).length,"件"]})]})}),a.jsx("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl border border-gray-200/50 shadow-xl shadow-black/5",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-purple-600 rounded-full",children:a.jsx(N.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"推し活口座"}),a.jsx("p",{className:"text-sm text-gray-600",children:"推し活動に使用する資金"})]})]}),a.jsx("button",{onClick:()=>A({...e.oshiAccount,transactions:e.recentTransactions.filter(e=>"oshi"===e.accountKind)}),className:"px-4 py-2 text-sm text-gray-600 bg-gray-50 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200 rounded-xl border border-gray-200/50",children:"詳細を見る"})]}),a.jsx("div",{className:"text-center mb-4",children:a.jsx("div",{className:"text-3xl font-bold text-gray-900",children:(0,c.xG)(e.oshiAccount?.balanceCached||0)})}),(0,a.jsxs)("div",{className:"text-center text-sm text-gray-600 mb-4",children:["取引件数: ",e.recentTransactions.filter(e=>"oshi"===e.accountKind&&!e.isPending).length,"件"]}),e.oshiAccount?.balanceCached<0&&(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-red-600",children:[a.jsx(g,{className:"w-4 h-4"}),a.jsx("span",{children:"残高不足が発生しています"})]})}),a.jsx(n.z,{onClick:()=>P(!0),className:"w-full bg-orange-500 hover:bg-orange-600 text-white mb-2",children:"資金移動"})]})]})})]}),e.rewards&&e.rewards.length>0&&a.jsx("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl border border-gray-200/50 shadow-xl shadow-black/5",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2",children:[a.jsx(y.Z,{className:"w-6 h-6 text-purple-600"}),"特典・サービス"]}),a.jsx("div",{className:"grid gap-4",children:e.rewards.map(s=>a.jsx("div",{className:"p-4 border border-gray-200 rounded-xl bg-white/60",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:s.title}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:s.description}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["推し活安心度スコア",s.minScore,"点以上で利用可能"]})]}),a.jsx(n.z,{size:"sm",disabled:!e.latestScore||e.latestScore.score<s.minScore,className:"ml-4 flex items-center gap-1",children:a.jsx(w.Z,{className:"w-4 h-4"})})]})},s.id))})]})}),S&&a.jsx(o,{account:S,transactions:S.transactions||[],onClose:()=>A(null)}),u&&a.jsx(m,{transaction:u,onClose:()=>k(null),onSave:q}),I&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-3xl shadow-2xl max-w-md w-full mx-4",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(g,{className:"w-8 h-8 text-red-500"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"⚠️ 残高不足の警告"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["推し活口座の残高がマイナスになっています。",a.jsx("br",{}),"生活口座から資金を移動しますか？"]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"現在の推し活口座残高"}),a.jsx("div",{className:"text-lg font-bold text-red-500",children:e?.oshiAccount?(0,c.xG)(e.oshiAccount.balanceCached):"￥0"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"生活口座残高"}),a.jsx("div",{className:"text-lg font-bold text-green-600",children:e?.lifeAccount?(0,c.xG)(e.lifeAccount.balanceCached):"￥0"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["移動する金額",e?.oshiAccount?.balanceCached<0&&a.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"(推奨: 不足分 + \xa510,000)"})]}),a.jsx("input",{type:"number",value:T,onChange:e=>$(e.target.value),placeholder:"移動する金額を入力",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",step:"1000"})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 mt-6",children:[a.jsx(n.z,{onClick:()=>{P(!1),$("")},variant:"outline",className:"flex-1",children:"後で"}),a.jsx(n.z,{onClick:Z,className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white",disabled:!T||0>=parseFloat(T),children:"振替実行"})]})]})})}),D&&a.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center z-50",children:a.jsx(h.g,{})})]}):a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx(h.g,{})})}},2927:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(2858).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},360:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(2858).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},9354:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>o});var a=t(1002),r=t(7460);let l=(0,r.createProxy)(String.raw`/Users/h-okano/Dev/softbank_hackason/apps/web/app/(authenticated)/dashboard/dashboard-content.tsx`),{__esModule:n,$$typeof:c}=l;l.default;let i=(0,r.createProxy)(String.raw`/Users/h-okano/Dev/softbank_hackason/apps/web/app/(authenticated)/dashboard/dashboard-content.tsx#DashboardContent`);function o(){return a.jsx(i,{})}}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[79,94,229,703],()=>t(9609));module.exports=a})();