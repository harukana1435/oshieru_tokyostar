(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{1966:function(e,t,r){Promise.resolve().then(r.bind(r,7682)),Promise.resolve().then(r.bind(r,6864))},7682:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthGuard:function(){return i}});var n=r(9075),a=r(511),s=r(5095),l=r(3629);function i(e){let{children:t,requireAuth:r=!0}=e,[i,o]=(0,a.useState)(null),[c,u]=(0,a.useState)(!0),d=(0,s.useRouter)();return((0,a.useEffect)(()=>{let e=()=>{let e=!!localStorage.getItem("sessionId");o(e),u(!1),r&&!e?d.push("/login"):!r&&e&&d.push("/dashboard")};e();let t=()=>{e()};return window.addEventListener("storage",t),()=>{window.removeEventListener("storage",t)}},[r,d]),c||r&&!i||!r&&i)?(0,n.jsx)(l.g,{}):(0,n.jsx)(n.Fragment,{children:t})}},6864:function(e,t,r){"use strict";r.r(t),r.d(t,{LoginForm:function(){return c}});var n=r(9075),a=r(511),s=r(5095),l=r(7839),i=r(1438),o=r(9042);function c(e){let{onLoginSuccess:t}=e,[r,c]=(0,a.useState)(""),[u,d]=(0,a.useState)(!1),[m,f]=(0,a.useState)([]),[h,p]=(0,a.useState)(!0),g=(0,s.useRouter)();(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat("https://oshieru-api.harukana1435.workers.dev","/users/demo"));if(e.ok){let t=await e.json();t.success&&f(t.users)}}catch(e){console.error("Failed to fetch demo users:",e),f([{id:"user_10000001",email:"customer1@oshieru.com",displayName:"顧客1",lifeBalance:38e4,oshiBalance:0,totalBalance:38e4},{id:"user_10000002",email:"customer2@oshieru.com",displayName:"顧客2",lifeBalance:25e4,oshiBalance:5e4,totalBalance:3e5},{id:"user_10000003",email:"customer3@oshieru.com",displayName:"顧客3",lifeBalance:15e4,oshiBalance:8e4,totalBalance:23e4}])}finally{p(!1)}})()},[]);let y=async e=>{e.preventDefault(),d(!0);try{let e=await fetch("".concat("https://oshieru-api.harukana1435.workers.dev","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})}),n=await e.json();n.success?(localStorage.setItem("currentUser",JSON.stringify(n.user)),localStorage.setItem("userEmail",r),localStorage.setItem("sessionId",n.sessionId),console.log("Login successful:",n.user),t&&t(),g.push("/dashboard")):(console.error("Login failed:",n.message),alert("ログインに失敗しました。メールアドレスを確認してください。"))}catch(e){console.error("Login error:",e),alert("ネットワークエラーが発生しました。しばらく経ってからお試しください。")}finally{d(!1)}},x=async e=>{console.log("Demo login attempt for:",e);try{let r=await fetch("".concat("https://oshieru-api.harukana1435.workers.dev","/auth/demo-login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),n=await r.json();if(n.success){localStorage.setItem("currentUser",JSON.stringify(n.user)),localStorage.setItem("userEmail",e),localStorage.setItem("sessionId",n.sessionId),console.log("Demo login successful:",n.user),t&&t(),g.push("/dashboard");return}}catch(n){console.error("Demo login failed:",n);let r=m.find(t=>t.email===e);r&&(localStorage.setItem("currentUser",JSON.stringify(r)),localStorage.setItem("userEmail",e),localStorage.setItem("sessionId","demo-session-".concat(Date.now())),console.log("Demo login successful with error fallback:",r),t&&t(),g.push("/dashboard"))}};return(0,n.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,n.jsxs)(i.Zb,{className:"w-full max-w-md card-accent",children:[(0,n.jsxs)(i.Ol,{className:"text-center",children:[(0,n.jsx)(i.ll,{className:"heading-2",children:"ログイン"}),(0,n.jsx)(i.SZ,{className:"body-medium",children:"推しエール口座にアクセスするためにメールアドレスを入力してください"})]}),(0,n.jsxs)(i.aY,{children:[(0,n.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"email",className:"block body-small font-medium mb-2 text-neutral-700",children:"メールアドレス"}),(0,n.jsx)("input",{id:"email",type:"email",value:r,onChange:e=>c(e.target.value),className:"input-field",placeholder:"your-email@example.com",required:!0})]}),(0,n.jsx)(l.z,{type:"submit",className:"w-full",disabled:u||!r,children:u?"処理中...":"ログイン"})]}),(0,n.jsxs)("div",{className:"mt-6 pt-4 border-t border-primary-200",children:[(0,n.jsx)("p",{className:"body-small font-medium mb-3 text-neutral-700",children:"デモアカウント"}),(0,n.jsx)("div",{className:"space-y-2",children:h?(0,n.jsx)("div",{className:"text-center py-4",children:(0,n.jsx)("p",{className:"body-small text-neutral-500",children:"残高情報を読み込み中..."})}):m.map((e,t)=>(0,n.jsx)(l.z,{onClick:t=>{t.preventDefault(),t.stopPropagation(),x(e.email)},variant:"outline",className:"w-full text-left justify-start h-auto py-3",children:(0,n.jsxs)("div",{className:"flex flex-col items-start",children:[(0,n.jsx)("span",{className:"font-medium text-neutral-800",children:e.displayName}),(0,n.jsxs)("span",{className:"caption text-neutral-500",children:["総残高: ",(0,o.xG)(e.totalBalance),e.lifeBalance>0&&e.oshiBalance>0&&(0,n.jsxs)("span",{className:"ml-1",children:["(生活: ",(0,o.xG)(e.lifeBalance),", 推し活: ",(0,o.xG)(e.oshiBalance),")"]})]})]})},e.id))}),(0,n.jsx)("p",{className:"caption text-neutral-400 text-center mt-3",children:"実際のデータベースから取得した顧客データを体験できます"})]})]})]})})}},7839:function(e,t,r){"use strict";r.d(t,{z:function(){return c}});var n=r(9075),a=r(511),s=r(5384),l=r(3452),i=r(9042);let o=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-medium transition-all duration-200 ease-in-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-300 focus-visible:ring-opacity-50 disabled:pointer-events-none disabled:opacity-50 touch-target",{variants:{variant:{default:"bg-primary-400 text-neutral-800 hover:bg-primary-500 active:bg-primary-600 shadow-normal hover:shadow-strong",destructive:"bg-error-500 text-white hover:bg-error-600 active:bg-error-700 shadow-normal hover:shadow-strong",outline:"border-2 border-primary-300 bg-transparent text-primary-600 hover:bg-primary-50 hover:border-primary-400 active:bg-primary-100",secondary:"bg-neutral-100 text-neutral-700 hover:bg-neutral-200 active:bg-neutral-300 shadow-soft hover:shadow-normal",ghost:"bg-transparent text-neutral-600 hover:bg-neutral-50 hover:text-neutral-700 active:bg-neutral-100",link:"text-primary-600 underline-offset-4 hover:underline hover:text-primary-700",success:"bg-success-500 text-white hover:bg-success-600 active:bg-success-700 shadow-normal hover:shadow-strong",warning:"bg-warning-500 text-white hover:bg-warning-600 active:bg-warning-700 shadow-normal hover:shadow-strong"},size:{default:"h-11 px-4 py-2 md:px-6 md:py-3",sm:"h-9 px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm",lg:"h-12 px-6 py-3 md:px-8 md:py-4 text-base md:text-lg",icon:"h-11 w-11 p-0"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,size:l,asChild:c=!1,...u}=e,d=c?s.g7:"button";return(0,n.jsx)(d,{className:(0,i.cn)(o({variant:a,size:l,className:r})),ref:t,...u})});c.displayName="Button"},1438:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return l},aY:function(){return u},ll:function(){return o}});var n=r(9075),a=r(511),s=r(9042);let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("rounded-xl md:rounded-2xl border border-neutral-200 bg-white shadow-normal hover:shadow-strong transition-all duration-200 ease-in-out",r),...a})});l.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-4 md:p-6",r),...a})});i.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("h3",{ref:t,className:(0,s.cn)("heading-3",r),...a})});o.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("p",{ref:t,className:(0,s.cn)("body-medium text-neutral-500",r),...a})});c.displayName="CardDescription";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("p-4 md:p-6 pt-0",r),...a})});u.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-4 md:p-6 pt-0",r),...a})}).displayName="CardFooter"},3629:function(e,t,r){"use strict";r.d(t,{g:function(){return s}});var n=r(9075);r(511);var a=r(1438);function s(){return(0,n.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,n.jsx)(a.Zb,{className:"w-full max-w-md",children:(0,n.jsx)(a.aY,{className:"flex items-center justify-center p-8",children:(0,n.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-400"}),(0,n.jsx)("p",{className:"body-medium text-neutral-500",children:"読み込み中..."})]})})})})}},9042:function(e,t,r){"use strict";r.d(t,{cn:function(){return s},o0:function(){return i},xG:function(){return l}});var n=r(8273),a=r(868);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,n.W)(t))}function l(e){let t=isNaN(e)||null==e?0:e,r=new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY"}).format(Math.abs(t));return t<0?"￥-".concat(r.slice(1)):r}function i(e){return new Intl.DateTimeFormat("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(e)}},4991:function(e,t,r){"use strict";r.d(t,{F:function(){return s},e:function(){return l}});var n=r(511);function a(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>{let r=!1,n=t.map(t=>{let n=a(t,e);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let e=0;e<n.length;e++){let r=n[e];"function"==typeof r?r():a(t[e],null)}}}}function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.useCallback(s(...t),t)}},5384:function(e,t,r){"use strict";r.d(t,{Z8:function(){return l},g7:function(){return i}});var n=r(511),a=r(4991),s=r(9075);function l(e){let t=function(e){let t=n.forwardRef((e,t)=>{let{children:r,...s}=e;if(n.isValidElement(r)){var l,i;let e,o;let c=(e=null===(l=Object.getOwnPropertyDescriptor(r.props,"ref"))||void 0===l?void 0:l.get)&&"isReactWarning"in e&&e.isReactWarning?r.ref:(e=null===(i=Object.getOwnPropertyDescriptor(r,"ref"))||void 0===i?void 0:i.get)&&"isReactWarning"in e&&e.isReactWarning?r.props.ref:r.props.ref||r.ref,u=function(e,t){let r={...t};for(let n in t){let a=e[n],s=t[n];/^on[A-Z]/.test(n)?a&&s?r[n]=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=s(...t);return a(...t),n}:a&&(r[n]=a):"style"===n?r[n]={...a,...s}:"className"===n&&(r[n]=[a,s].filter(Boolean).join(" "))}return{...e,...r}}(s,r.props);return r.type!==n.Fragment&&(u.ref=t?(0,a.F)(t,c):c),n.cloneElement(r,u)}return n.Children.count(r)>1?n.Children.only(null):null});return t.displayName="".concat(e,".SlotClone"),t}(e),r=n.forwardRef((e,r)=>{let{children:a,...l}=e,i=n.Children.toArray(a),o=i.find(c);if(o){let e=o.props.children,a=i.map(t=>t!==o?t:n.Children.count(e)>1?n.Children.only(null):n.isValidElement(e)?e.props.children:null);return(0,s.jsx)(t,{...l,ref:r,children:n.isValidElement(e)?n.cloneElement(e,void 0,a):null})}return(0,s.jsx)(t,{...l,ref:r,children:a})});return r.displayName="".concat(e,".Slot"),r}var i=l("Slot"),o=Symbol("radix.slottable");function c(e){return n.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===o}},3452:function(e,t,r){"use strict";r.d(t,{j:function(){return l}});var n=r(8273);let a=e=>"boolean"==typeof e?"".concat(e):0===e?"0":e,s=n.W,l=(e,t)=>r=>{var n;if((null==t?void 0:t.variants)==null)return s(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:l,defaultVariants:i}=t,o=Object.keys(l).map(e=>{let t=null==r?void 0:r[e],n=null==i?void 0:i[e];if(null===t)return null;let s=a(t)||a(n);return l[e][s]}),c=r&&Object.entries(r).reduce((e,t)=>{let[r,n]=t;return void 0===n||(e[r]=n),e},{});return s(e,o,null==t?void 0:null===(n=t.compoundVariants)||void 0===n?void 0:n.reduce((e,t)=>{let{class:r,className:n,...a}=t;return Object.entries(a).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...i,...c}[t]):({...i,...c})[t]===r})?[...e,r,n]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}}},function(e){e.O(0,[682,852,999,744],function(){return e(e.s=1966)}),_N_E=e.O()}]);