(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[598],{1890:function(e,t,s){Promise.resolve().then(s.bind(s,1410))},1410:function(e,t,s){"use strict";s.r(t),s.d(t,{DashboardContent:function(){return k}});var a=s(9075),r=s(511),n=s(5095),l=s(7839),i=s(9042),c=s(1438);function o(e){let{account:t,transactions:s,onClose:r}=e,n=s.filter(e=>{if(e.accountId&&t.id){let s=e.accountId===t.id;return s&&console.log("Transaction ".concat(e.id," matched by accountId: ").concat(e.accountId," === ").concat(t.id)),s}if(e.accountKind){let s=e.accountKind===t.kind;return s&&console.log("Transaction ".concat(e.id," matched by accountKind: ").concat(e.accountKind," === ").concat(t.kind)),s}let s="life"===t.kind&&"ticket"!==e.purpose&&"goods"!==e.purpose&&"event"!==e.purpose||"oshi"===t.kind&&("ticket"===e.purpose||"goods"===e.purpose||"event"===e.purpose);return s&&console.log("Transaction ".concat(e.id," matched by purpose fallback: purpose=").concat(e.purpose,", account.kind=").concat(t.kind)),s});console.log("AccountDetailsModal: Found ".concat(n.length," transactions for account ").concat(t.name," (").concat(t.kind,")")),console.log("Account ID:",t.id),console.log("All transactions count:",s.length);let o=n.filter(e=>"in"===e.sign).reduce((e,t)=>e+t.amount,0),d=n.filter(e=>"out"===e.sign).reduce((e,t)=>e+t.amount,0);return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(c.Zb,{className:"w-full max-w-4xl max-h-[90vh] flex flex-col bg-white shadow-2xl",children:[(0,a.jsx)(c.Ol,{className:"flex-shrink-0 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-purple-50",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(c.ll,{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:["life"===t.kind?"\uD83D\uDCB0":"✨"," ",t.name,"詳細"]}),(0,a.jsxs)(c.SZ,{className:"text-lg font-semibold text-blue-600 mt-1",children:["残高: ",(0,i.xG)(t.balanceCached)]})]}),(0,a.jsx)(l.z,{variant:"ghost",onClick:r,className:"hover:bg-white/80 rounded-full w-10 h-10 p-0",children:(0,a.jsx)("span",{className:"text-xl text-gray-500 hover:text-gray-700",children:"✕"})})]})}),(0,a.jsxs)(c.aY,{className:"flex-1 overflow-y-auto p-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"p-6 bg-gradient-to-br from-green-50 to-emerald-100 rounded-xl border border-green-200 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCC8"}),(0,a.jsx)("p",{className:"text-sm font-medium text-green-700",children:"総収入"})]}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-800",children:(0,i.xG)(o)})]}),(0,a.jsxs)("div",{className:"p-6 bg-gradient-to-br from-red-50 to-rose-100 rounded-xl border border-red-200 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCC9"}),(0,a.jsx)("p",{className:"text-sm font-medium text-red-700",children:"総支出"})]}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-800",children:(0,i.xG)(d)})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("span",{className:"text-xl",children:"\uD83D\uDCCB"}),(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:"取引履歴"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:[n.length,"件"]})]}),(0,a.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:0===n.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("span",{className:"text-4xl mb-4 block",children:"\uD83D\uDCED"}),(0,a.jsx)("p",{className:"text-gray-500 font-medium",children:"取引履歴がありません"})]}):n.sort((e,t)=>new Date(t.eventAt).getTime()-new Date(e.eventAt).getTime()).map(e=>(0,a.jsx)("div",{className:"p-4 rounded-xl border transition-all hover:shadow-md ".concat(e.isPending?"bg-gradient-to-r from-yellow-50 to-amber-50 border-yellow-300 shadow-sm":e.isAutoCategorized?"bg-gradient-to-r from-green-50 to-emerald-50 border-green-300 shadow-sm":"bg-gradient-to-r from-gray-50 to-slate-50 border-gray-200"),children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"font-medium",children:e.memo}),e.isAutoCategorized&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded-full",children:"自動分類"}),e.isPending&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-yellow-100 text-yellow-700 rounded-full",children:"保留中"})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,i.o0)(e.eventAt)," • ",e.purpose]})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsxs)("p",{className:"font-medium ".concat("out"===e.sign?"text-red-600":"text-green-600"),children:["out"===e.sign?"-":"+",(0,i.xG)(e.amount)]})})]})},e.id))})]})]})]})})}let d=[{value:"salary",label:"給与・収入"},{value:"ticket",label:"チケット"},{value:"goods",label:"グッズ"},{value:"event",label:"イベント"},{value:"food",label:"食費"},{value:"rent",label:"家賃・住居費"},{value:"utilities",label:"光熱費・通信費"},{value:"transport",label:"交通費"},{value:"other",label:"その他"}],u=[{value:"life",label:"生活口座"},{value:"oshi",label:"推し活口座"}];function m(e){var t;let{transaction:s,onSave:n,onClose:o}=e,[m,x]=(0,r.useState)({...s}),[h,f]=(0,r.useState)(["ticket","goods","event"].includes(s.purpose)?"oshi":"life");(0,r.useEffect)(()=>{x({...s}),s.accountKind?f(s.accountKind):f(["ticket","goods","event"].includes(s.purpose)?"oshi":"life")},[s]);let g=async()=>{let e=m.purpose;"oshi"!==h||["ticket","goods","event"].includes(e)||(e="other");try{let t=await fetch("".concat("https://oshieru-api.harukana1435.workers.dev","/transactions/").concat(s.id),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("sessionId")),"X-User-Email":localStorage.getItem("userEmail")||""},body:JSON.stringify({purpose:e,memo:m.memo,accountType:h})});if(t.ok){let e=await t.json();console.log("Transaction updated via API:",e);let s={...e.transaction,eventAt:new Date(e.transaction.eventAt),createdAt:new Date(e.transaction.createdAt),isAutoCategorized:!1,isPending:!1};n(s),o()}else console.error("Failed to update transaction:",await t.text()),alert("取引の更新に失敗しました")}catch(e){console.error("Error updating transaction:",e),alert("取引の更新中にエラーが発生しました")}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(c.Zb,{className:"w-full max-w-md",children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(c.ll,{children:"取引を編集"}),(0,a.jsxs)(c.SZ,{children:[(0,i.xG)(s.amount)," • ",s.eventAt.toLocaleDateString("ja-JP")]})]}),(0,a.jsx)(l.z,{variant:"ghost",onClick:o,children:"✕"})]})}),(0,a.jsxs)(c.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"元の摘要"}),(0,a.jsx)("p",{className:"p-2 bg-gray-50 rounded text-sm",children:s.originalDescription||s.memo})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"メモ"}),(0,a.jsx)("input",{type:"text",value:m.memo,onChange:e=>x({...m,memo:e.target.value}),className:"w-full p-2 border rounded mt-1",placeholder:"メモを入力"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"口座種別"}),(0,a.jsx)("select",{value:h,onChange:e=>f(e.target.value),className:"w-full p-2 border rounded mt-1",children:u.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"用途"}),(0,a.jsx)("select",{value:m.purpose,onChange:e=>x({...m,purpose:e.target.value}),className:"w-full p-2 border rounded mt-1",children:d.filter(e=>"oshi"===h?["ticket","goods","event","other"].includes(e.value):!["ticket","goods","event"].includes(e.value)).map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsx)("div",{className:"p-3 bg-blue-50 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-blue-700",children:[(0,a.jsx)("strong",{children:"編集後:"})," ","life"===h?"生活口座":"推し活口座"," • ",null===(t=d.find(e=>e.value===m.purpose))||void 0===t?void 0:t.label]})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(l.z,{variant:"outline",onClick:o,className:"flex-1",children:"キャンセル"}),(0,a.jsx)(l.z,{onClick:g,className:"flex-1",children:"保存"})]})]})]})})}var x=s(3629),h=s(9804);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let f=(0,h.Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),g=(0,h.Z)("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),p=(0,h.Z)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),b=(0,h.Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var v=s(5135),j=s(3438),y=s(4597),N=s(1354),w=s(3942);function k(){var e,t,s,c,d,u,h;let[k,C]=(0,r.useState)(null),[A,S]=(0,r.useState)(!0),[D,I]=(0,r.useState)(null),[Z,T]=(0,r.useState)(null),[z,E]=(0,r.useState)(null),[O,P]=(0,r.useState)(!1),[M,B]=(0,r.useState)(!1),[R,K]=(0,r.useState)(""),[G,J]=(0,r.useState)(!1),[_,F]=(0,r.useState)(!1),U=(0,n.useRouter)();(0,r.useEffect)(()=>{(async()=>{try{S(!0);let e=localStorage.getItem("currentUser");if(!e){U.push("/login");return}let t=JSON.parse(e),s="https://oshieru-api.harukana1435.workers.dev",a=localStorage.getItem("sessionId");console.log("Dashboard API request details:",{userId:t.id,userEmail:t.email,sessionId:a,apiUrl:s});let r=t.email||localStorage.getItem("userEmail")||"customer1@oshieru.com",n=await fetch("".concat(s,"/dashboard"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a),"X-User-Email":r},body:JSON.stringify({userId:t.id})});if(!n.ok)throw Error("Failed to fetch dashboard data");let l=await n.json();if(l.success){let e=l.data.accounts||[],t=l.data.recentTransactions||[],s={user:l.data.user,accounts:e,totalBalance:e.reduce((e,t)=>e+(t.balanceCached||0),0),lifeAccount:e.find(e=>"life"===e.kind),oshiAccount:e.find(e=>"oshi"===e.kind),latestScore:l.data.latestScore,recentTransactions:t.map(e=>{var t,s;return{...e,eventAt:new Date(e.eventAt),createdAt:new Date(e.createdAt),accountKind:e.accountKind||((null===(t=e.accountId)||void 0===t?void 0:t.includes("life"))?"life":"oshi"),accountName:e.accountName||((null===(s=e.accountId)||void 0===s?void 0:s.includes("life"))?"生活口座":"推し活口座")}}),rewards:l.data.rewards||[],transactionCount:t.length},a=s.recentTransactions.filter(e=>"life"===e.accountKind),r=s.recentTransactions.filter(e=>"oshi"===e.accountKind),n=0;a.length>0&&(n=a.reduce((e,t)=>e+("in"===t.sign?t.amount:-t.amount),0));let i=0;r.length>0&&(i=r.reduce((e,t)=>e+("in"===t.sign?t.amount:-t.amount),0)),s.lifeBalance=n,s.oshiBalance=i,s.totalBalance=n+i,C(s)}else I(l.message||"データの取得に失敗しました")}catch(e){console.error("Dashboard fetch error:",e),I("ネットワークエラーが発生しました")}finally{S(!1)}})()},[U]),(0,r.useEffect)(()=>{k&&k.oshiAccount&&k.oshiAccount.balanceCached<0&&B(!0)},[k]),(0,r.useEffect)(()=>{var e;M&&(null==k?void 0:null===(e=k.oshiAccount)||void 0===e?void 0:e.balanceCached)<0&&K((Math.abs(k.oshiAccount.balanceCached)+1e4).toString())},[M,k]);let W=async()=>{try{P(!0);let e=parseFloat(R);if(!e||e<=0){alert("正しい金額を入力してください");return}if(!k.lifeAccount||k.lifeAccount.balanceCached<e){alert("生活口座の残高が不足しています");return}let t=localStorage.getItem("currentUser");if(!t)return;let s=JSON.parse(t),a="https://oshieru-api.harukana1435.workers.dev",r=localStorage.getItem("sessionId"),n=s.email||localStorage.getItem("userEmail")||"customer1@oshieru.com",l={accountId:k.lifeAccount.id,amount:e,sign:"out",purpose:"fund_transfer",memo:"資金移動 → 推し活口座 (￥".concat(e.toLocaleString(),")"),eventAt:new Date().toISOString()},i={accountId:k.oshiAccount.id,amount:e,sign:"in",purpose:"fund_transfer",memo:"資金移動 ← 生活口座 (￥".concat(e.toLocaleString(),")"),eventAt:new Date().toISOString()},c=await fetch("".concat(a,"/transactions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r),"X-User-Email":n},body:JSON.stringify(l)}),o=await fetch("".concat(a,"/transactions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r),"X-User-Email":n},body:JSON.stringify(i)});c.ok&&o.ok?window.location.reload():alert("振替処理に失敗しました")}catch(e){console.error("Balance transfer error:",e),alert("振替処理中にエラーが発生しました")}finally{P(!1),B(!1),K("")}},V=async e=>{try{P(!0);let e=localStorage.getItem("currentUser");if(!e)return;let t=JSON.parse(e),s=localStorage.getItem("sessionId"),a=t.email||localStorage.getItem("userEmail")||"customer1@oshieru.com",r=await fetch("".concat("https://oshieru-api.harukana1435.workers.dev","/dashboard"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s),"X-User-Email":a},body:JSON.stringify({userId:t.id})});if(r.ok){let e=await r.json();if(e.success){let t=e.data.accounts||[],s=e.data.recentTransactions||[],a={user:e.data.user,accounts:t,totalBalance:t.reduce((e,t)=>e+(t.balanceCached||0),0),lifeAccount:t.find(e=>"life"===e.kind),oshiAccount:t.find(e=>"oshi"===e.kind),latestScore:e.data.latestScore,recentTransactions:s.map(e=>{var t,s;return{...e,eventAt:new Date(e.eventAt),createdAt:new Date(e.createdAt),accountKind:e.accountKind||((null===(t=e.accountId)||void 0===t?void 0:t.includes("life"))?"life":"oshi"),accountName:e.accountName||((null===(s=e.accountId)||void 0===s?void 0:s.includes("life"))?"生活口座":"推し活口座")}}),rewards:e.data.rewards||[],transactionCount:s.length};C(a)}}}catch(e){console.error("Transaction update error:",e)}finally{P(!1)}};return A?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(x.g,{})}):D?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-red-600 mb-4",children:D}),(0,a.jsx)(l.z,{onClick:()=>window.location.reload(),children:"再試行"})]})}):k?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl border border-gray-200/50 shadow-xl shadow-black/5",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-3 bg-gradient-to-r from-green-500 to-blue-500 rounded-full",children:(0,a.jsx)(f,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"推し活安心度スコア"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"健康的な推し活の指標"})]})]}),(0,a.jsx)("button",{onClick:()=>J(!G),className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors",children:(0,a.jsx)(g,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row items-center gap-8",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(e=>{let{score:t,size:s=120}=e,r=(s-20)/2,n=2*Math.PI*r*.75,l=n-n*t/100;return(0,a.jsxs)("div",{className:"relative inline-flex items-center justify-center",children:[(0,a.jsxs)("svg",{width:s,height:s,className:"transform -rotate-45",children:[(0,a.jsx)("circle",{cx:s/2,cy:s/2,r:r,fill:"none",stroke:"#e5e7eb",strokeWidth:"8",strokeDasharray:n,strokeDashoffset:"0",strokeLinecap:"round"}),(0,a.jsx)("circle",{cx:s/2,cy:s/2,r:r,fill:"none",stroke:t>=80?"#10b981":t>=60?"#f59e0b":t>=40?"#ef4444":"#6b7280",strokeWidth:"8",strokeDasharray:n,strokeDashoffset:l,strokeLinecap:"round",className:"transition-all duration-1000 ease-out"})]}),(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:t}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"点"})]})]})},{score:(null===(e=k.latestScore)||void 0===e?void 0:e.score)||0})}),(0,a.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"評価レベル"}),(0,a.jsx)("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:(null===(t=k.latestScore)||void 0===t?void 0:t.label)||"評価中"})]}),(null===(s=k.latestScore)||void 0===s?void 0:s.factors)&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("button",{onClick:()=>F(!_),className:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-800 transition-colors",children:["詳細を表示",_?(0,a.jsx)(p,{className:"w-4 h-4"}):(0,a.jsx)(b,{className:"w-4 h-4"})]}),_&&(0,a.jsxs)("div",{className:"space-y-3 p-4 bg-gray-50/80 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"推し活費の割合"}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[Math.round(k.latestScore.factors.incomeRatio),"%"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"余剰資金比率"}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[Math.round(100*k.latestScore.factors.surplusRatio),"%"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"推奨金額からの乖離"}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[Math.round(k.latestScore.factors.recommendedDeviation),"%"]})]})]})]})]})]}),G&&(0,a.jsxs)("div",{className:"mt-6 p-4 bg-blue-50/80 rounded-lg border border-blue-200",children:[(0,a.jsx)("h4",{className:"font-semibold text-blue-900 mb-2",children:"スコアについて"}),(0,a.jsxs)("div",{className:"text-sm text-blue-800 space-y-1",children:[(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"80点以上"}),": 非常に健全な推し活状況"]}),(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"60-79点"}),": 良好な推し活状況"]}),(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"40-59点"}),": 注意が必要な状況"]}),(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"40点未満"}),": 改善が必要な状況"]})]})]})]})}),(0,a.jsx)("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl border border-gray-200/50 shadow-xl shadow-black/5",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full",children:(0,a.jsx)(v.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"総残高"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"全口座の合計金額"})]})]}),(0,a.jsx)("button",{onClick:()=>U.push("/transactions"),className:"px-4 py-2 text-sm text-gray-600 bg-gray-50 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200 rounded-xl border border-gray-200/50",children:"取引履歴を見る"})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("div",{className:"text-4xl font-bold text-gray-900",children:(0,i.xG)(k.totalBalance||0)})})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl border border-gray-200/50 shadow-xl shadow-black/5",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-3 bg-gradient-to-r from-green-500 to-green-600 rounded-full",children:(0,a.jsx)(j.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"生活口座"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"日常生活に必要な資金"})]})]}),(0,a.jsx)("button",{onClick:()=>E({...k.lifeAccount,transactions:k.recentTransactions.filter(e=>"life"===e.accountKind)}),className:"px-4 py-2 text-sm text-gray-600 bg-gray-50 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200 rounded-xl border border-gray-200/50",children:"詳細を見る"})]}),(0,a.jsx)("div",{className:"text-center mb-4",children:(0,a.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:(0,i.xG)((null===(c=k.lifeAccount)||void 0===c?void 0:c.balanceCached)||0)})}),(0,a.jsxs)("div",{className:"text-center text-sm text-gray-600",children:["取引件数: ",k.recentTransactions.filter(e=>"life"===e.accountKind&&!e.isPending).length,"件"]})]})}),(0,a.jsx)("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl border border-gray-200/50 shadow-xl shadow-black/5",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-purple-600 rounded-full",children:(0,a.jsx)(y.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"推し活口座"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"推し活動に使用する資金"})]})]}),(0,a.jsx)("button",{onClick:()=>E({...k.oshiAccount,transactions:k.recentTransactions.filter(e=>"oshi"===e.accountKind)}),className:"px-4 py-2 text-sm text-gray-600 bg-gray-50 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200 rounded-xl border border-gray-200/50",children:"詳細を見る"})]}),(0,a.jsx)("div",{className:"text-center mb-4",children:(0,a.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:(0,i.xG)((null===(d=k.oshiAccount)||void 0===d?void 0:d.balanceCached)||0)})}),(0,a.jsxs)("div",{className:"text-center text-sm text-gray-600 mb-4",children:["取引件数: ",k.recentTransactions.filter(e=>"oshi"===e.accountKind&&!e.isPending).length,"件"]}),(null===(u=k.oshiAccount)||void 0===u?void 0:u.balanceCached)<0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-red-600",children:[(0,a.jsx)(f,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"残高不足が発生しています"})]})}),(0,a.jsx)(l.z,{onClick:()=>B(!0),className:"w-full bg-orange-500 hover:bg-orange-600 text-white mb-2",children:"資金移動"})]})]})})]}),k.rewards&&k.rewards.length>0&&(0,a.jsx)("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl border border-gray-200/50 shadow-xl shadow-black/5",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2",children:[(0,a.jsx)(N.Z,{className:"w-6 h-6 text-purple-600"}),"特典・サービス"]}),(0,a.jsx)("div",{className:"grid gap-4",children:k.rewards.map(e=>(0,a.jsx)("div",{className:"p-4 border border-gray-200 rounded-xl bg-white/60",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.description}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["推し活安心度スコア",e.minScore,"点以上で利用可能"]})]}),(0,a.jsx)(l.z,{size:"sm",disabled:!k.latestScore||k.latestScore.score<e.minScore,className:"ml-4 flex items-center gap-1",children:(0,a.jsx)(w.Z,{className:"w-4 h-4"})})]})},e.id))})]})}),z&&(0,a.jsx)(o,{account:z,transactions:z.transactions||[],onClose:()=>E(null)}),Z&&(0,a.jsx)(m,{transaction:Z,onClose:()=>T(null),onSave:V}),M&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-3xl shadow-2xl max-w-md w-full mx-4",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(f,{className:"w-8 h-8 text-red-500"})}),(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"⚠️ 残高不足の警告"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["推し活口座の残高がマイナスになっています。",(0,a.jsx)("br",{}),"生活口座から資金を移動しますか？"]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"現在の推し活口座残高"}),(0,a.jsx)("div",{className:"text-lg font-bold text-red-500",children:(null==k?void 0:k.oshiAccount)?(0,i.xG)(k.oshiAccount.balanceCached):"￥0"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"生活口座残高"}),(0,a.jsx)("div",{className:"text-lg font-bold text-green-600",children:(null==k?void 0:k.lifeAccount)?(0,i.xG)(k.lifeAccount.balanceCached):"￥0"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["移動する金額",(null==k?void 0:null===(h=k.oshiAccount)||void 0===h?void 0:h.balanceCached)<0&&(0,a.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(推奨: 不足分 + \xa510,000)"})]}),(0,a.jsx)("input",{type:"number",value:R,onChange:e=>K(e.target.value),placeholder:"移動する金額を入力",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",step:"1000"})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,a.jsx)(l.z,{onClick:()=>{B(!1),K("")},variant:"outline",className:"flex-1",children:"後で"}),(0,a.jsx)(l.z,{onClick:W,className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white",disabled:!R||0>=parseFloat(R),children:"振替実行"})]})]})})}),O&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center z-50",children:(0,a.jsx)(x.g,{})})]}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(x.g,{})})}},7839:function(e,t,s){"use strict";s.d(t,{z:function(){return o}});var a=s(9075),r=s(511),n=s(5384),l=s(3452),i=s(9042);let c=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-medium transition-all duration-200 ease-in-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-300 focus-visible:ring-opacity-50 disabled:pointer-events-none disabled:opacity-50 touch-target",{variants:{variant:{default:"bg-primary-400 text-neutral-800 hover:bg-primary-500 active:bg-primary-600 shadow-normal hover:shadow-strong",destructive:"bg-error-500 text-white hover:bg-error-600 active:bg-error-700 shadow-normal hover:shadow-strong",outline:"border-2 border-primary-300 bg-transparent text-primary-600 hover:bg-primary-50 hover:border-primary-400 active:bg-primary-100",secondary:"bg-neutral-100 text-neutral-700 hover:bg-neutral-200 active:bg-neutral-300 shadow-soft hover:shadow-normal",ghost:"bg-transparent text-neutral-600 hover:bg-neutral-50 hover:text-neutral-700 active:bg-neutral-100",link:"text-primary-600 underline-offset-4 hover:underline hover:text-primary-700",success:"bg-success-500 text-white hover:bg-success-600 active:bg-success-700 shadow-normal hover:shadow-strong",warning:"bg-warning-500 text-white hover:bg-warning-600 active:bg-warning-700 shadow-normal hover:shadow-strong"},size:{default:"h-11 px-4 py-2 md:px-6 md:py-3",sm:"h-9 px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm",lg:"h-12 px-6 py-3 md:px-8 md:py-4 text-base md:text-lg",icon:"h-11 w-11 p-0"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,t)=>{let{className:s,variant:r,size:l,asChild:o=!1,...d}=e,u=o?n.g7:"button";return(0,a.jsx)(u,{className:(0,i.cn)(c({variant:r,size:l,className:s})),ref:t,...d})});o.displayName="Button"},1438:function(e,t,s){"use strict";s.d(t,{Ol:function(){return i},SZ:function(){return o},Zb:function(){return l},aY:function(){return d},ll:function(){return c}});var a=s(9075),r=s(511),n=s(9042);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl md:rounded-2xl border border-neutral-200 bg-white shadow-normal hover:shadow-strong transition-all duration-200 ease-in-out",s),...r})});l.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-4 md:p-6",s),...r})});i.displayName="CardHeader";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("heading-3",s),...r})});c.displayName="CardTitle";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("body-medium text-neutral-500",s),...r})});o.displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-4 md:p-6 pt-0",s),...r})});d.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-4 md:p-6 pt-0",s),...r})}).displayName="CardFooter"},3629:function(e,t,s){"use strict";s.d(t,{g:function(){return n}});var a=s(9075);s(511);var r=s(1438);function n(){return(0,a.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,a.jsx)(r.Zb,{className:"w-full max-w-md",children:(0,a.jsx)(r.aY,{className:"flex items-center justify-center p-8",children:(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-400"}),(0,a.jsx)("p",{className:"body-medium text-neutral-500",children:"読み込み中..."})]})})})})}},9042:function(e,t,s){"use strict";s.d(t,{cn:function(){return n},o0:function(){return i},xG:function(){return l}});var a=s(8273),r=s(868);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}function l(e){let t=isNaN(e)||null==e?0:e,s=new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY"}).format(Math.abs(t));return t<0?"￥-".concat(s.slice(1)):s}function i(e){return new Intl.DateTimeFormat("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(e)}},9804:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(511),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),l=(e,t)=>{let s=(0,a.forwardRef)((s,l)=>{let{color:i="currentColor",size:c=24,strokeWidth:o=2,absoluteStrokeWidth:d,className:u="",children:m,...x}=s;return(0,a.createElement)("svg",{ref:l,...r,width:c,height:c,stroke:i,strokeWidth:d?24*Number(o)/Number(c):o,className:["lucide","lucide-".concat(n(e)),u].join(" "),...x},[...t.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(m)?m:[m]])});return s.displayName="".concat(e),s}},3942:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(9804).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},5135:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(9804).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},1354:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(9804).Z)("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]])},4597:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(9804).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},3438:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(9804).Z)("PiggyBank",[["path",{d:"M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2h0V5z",key:"uf6l00"}],["path",{d:"M2 9v1c0 1.1.9 2 2 2h1",key:"nm575m"}],["path",{d:"M16 11h0",key:"k2aug8"}]])},4991:function(e,t,s){"use strict";s.d(t,{F:function(){return n},e:function(){return l}});var a=s(511);function r(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return e=>{let s=!1,a=t.map(t=>{let a=r(t,e);return s||"function"!=typeof a||(s=!0),a});if(s)return()=>{for(let e=0;e<a.length;e++){let s=a[e];"function"==typeof s?s():r(t[e],null)}}}}function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return a.useCallback(n(...t),t)}},5384:function(e,t,s){"use strict";s.d(t,{Z8:function(){return l},g7:function(){return i}});var a=s(511),r=s(4991),n=s(9075);function l(e){let t=function(e){let t=a.forwardRef((e,t)=>{let{children:s,...n}=e;if(a.isValidElement(s)){var l,i;let e,c;let o=(e=null===(l=Object.getOwnPropertyDescriptor(s.props,"ref"))||void 0===l?void 0:l.get)&&"isReactWarning"in e&&e.isReactWarning?s.ref:(e=null===(i=Object.getOwnPropertyDescriptor(s,"ref"))||void 0===i?void 0:i.get)&&"isReactWarning"in e&&e.isReactWarning?s.props.ref:s.props.ref||s.ref,d=function(e,t){let s={...t};for(let a in t){let r=e[a],n=t[a];/^on[A-Z]/.test(a)?r&&n?s[a]=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];let a=n(...t);return r(...t),a}:r&&(s[a]=r):"style"===a?s[a]={...r,...n}:"className"===a&&(s[a]=[r,n].filter(Boolean).join(" "))}return{...e,...s}}(n,s.props);return s.type!==a.Fragment&&(d.ref=t?(0,r.F)(t,o):o),a.cloneElement(s,d)}return a.Children.count(s)>1?a.Children.only(null):null});return t.displayName="".concat(e,".SlotClone"),t}(e),s=a.forwardRef((e,s)=>{let{children:r,...l}=e,i=a.Children.toArray(r),c=i.find(o);if(c){let e=c.props.children,r=i.map(t=>t!==c?t:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,n.jsx)(t,{...l,ref:s,children:a.isValidElement(e)?a.cloneElement(e,void 0,r):null})}return(0,n.jsx)(t,{...l,ref:s,children:r})});return s.displayName="".concat(e,".Slot"),s}var i=l("Slot"),c=Symbol("radix.slottable");function o(e){return a.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===c}},3452:function(e,t,s){"use strict";s.d(t,{j:function(){return l}});var a=s(8273);let r=e=>"boolean"==typeof e?"".concat(e):0===e?"0":e,n=a.W,l=(e,t)=>s=>{var a;if((null==t?void 0:t.variants)==null)return n(e,null==s?void 0:s.class,null==s?void 0:s.className);let{variants:l,defaultVariants:i}=t,c=Object.keys(l).map(e=>{let t=null==s?void 0:s[e],a=null==i?void 0:i[e];if(null===t)return null;let n=r(t)||r(a);return l[e][n]}),o=s&&Object.entries(s).reduce((e,t)=>{let[s,a]=t;return void 0===a||(e[s]=a),e},{});return n(e,c,null==t?void 0:null===(a=t.compoundVariants)||void 0===a?void 0:a.reduce((e,t)=>{let{class:s,className:a,...r}=t;return Object.entries(r).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...i,...o}[t]):({...i,...o})[t]===s})?[...e,s,a]:e},[]),null==s?void 0:s.class,null==s?void 0:s.className)}}},function(e){e.O(0,[682,852,999,744],function(){return e(e.s=1890)}),_N_E=e.O()}]);