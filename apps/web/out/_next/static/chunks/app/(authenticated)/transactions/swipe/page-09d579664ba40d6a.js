(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[356],{7947:function(e,t,r){Promise.resolve().then(r.bind(r,4036))},4036:function(e,t,r){"use strict";r.r(t),r.d(t,{SwipeTransactionContent:function(){return h}});var n=r(9075),a=r(511),s=r(5095),l=r(1438),i=r(7839),o=r(9042),c=r(9627);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,r(9804).Z)("Hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0",key:"aigmz7"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v2",key:"1n6bmn"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v8",key:"a9iiix"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]);var u=r(3942);function m(e){let{onBack:t,onUpdate:r}=e,[s,m]=(0,a.useState)([]),[h,x]=(0,a.useState)(0),[f,p]=(0,a.useState)(!0),[g,v]=(0,a.useState)(!1),[b,y]=(0,a.useState)({x:0,y:0}),[j,N]=(0,a.useState)(null),[w,k]=(0,a.useState)({x:0,y:0}),[C,S]=(0,a.useState)(!1),[A,Z]=(0,a.useState)(!1),[E,M]=(0,a.useState)(null),R=(0,a.useRef)(null);(0,a.useEffect)(()=>{z()},[]);let z=async()=>{try{let e=await fetch("".concat("https://oshieru-api.harukana1435.workers.dev","/dashboard/pending-transactions"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("sessionId")),"X-User-Email":localStorage.getItem("userEmail")||""}});if(e.ok){let t=await e.json();if(t.success){let e=t.data.map(e=>({...e,eventAt:new Date(e.eventAt),createdAt:new Date(e.createdAt)}));m(e)}}}catch(e){console.error("Failed to load pending transactions:",e)}finally{p(!1)}},_=()=>{v(!1),y({x:0,y:0}),N(null),Z(!1),M(null)},D=async e=>{if(h>=s.length||C)return;let t=s[h],n="right"===e?"goods":"other",a="right"===e?"oshi":"life";Z(!0),M(e),S(!0);try{(await fetch("".concat("https://oshieru-api.harukana1435.workers.dev","/transactions/").concat(t.id),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("sessionId")),"X-User-Email":localStorage.getItem("userEmail")||""},body:JSON.stringify({purpose:n,accountId:"acc_".concat(a,"_").concat(t.accountId.split("_")[2])})})).ok?setTimeout(()=>{x(e=>e+1),_(),S(!1),r&&r()},1500):(console.error("Failed to update transaction"),_(),S(!1))}catch(e){console.error("Error updating transaction:",e),_(),S(!1)}},I=()=>{g&&!C&&(Math.abs(b.x)>120?D(b.x>0?"right":"left"):_())};if(f)return(0,n.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"振り分け未完了取引を読み込み中..."})]})});if(h>=s.length)return(0,n.jsx)("div",{className:"text-center py-12",children:(0,n.jsx)(l.Zb,{className:"max-w-md mx-auto",children:(0,n.jsxs)(l.aY,{className:"p-8",children:[(0,n.jsx)("h2",{className:"text-3xl font-bold text-green-600",children:"振り分け完了！"}),(0,n.jsxs)("p",{className:"text-muted-foreground mt-4 mb-8",children:["すべての取引の振り分けが完了しました。",(0,n.jsx)("br",{}),"ダッシュボードで結果を確認してください。"]}),(0,n.jsx)(i.z,{onClick:t,className:"bg-green-500 hover:bg-green-600 text-white px-8 py-3",children:"ダッシュボードに戻る"})]})})});let O=s[h],T=s.length-h;return(0,n.jsxs)("div",{className:"space-y-8 max-w-2xl mx-auto p-4",children:[(0,n.jsx)("div",{className:"md:hidden fixed top-4 left-4 z-50",children:(0,n.jsxs)(i.z,{onClick:t,variant:"outline",className:"flex items-center gap-2 bg-white shadow-lg",children:[(0,n.jsx)(c.Z,{className:"w-4 h-4"}),"戻る"]})}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,n.jsx)(d,{className:"w-7 h-7 text-blue-600"}),"スワイプで振り分け"]}),(0,n.jsx)("p",{className:"text-muted-foreground mt-1",children:C?(0,n.jsxs)("span",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),"処理中..."]}):"残り ".concat(T," 件の取引を振り分けします")})]}),(0,n.jsxs)(i.z,{onClick:t,variant:"outline",className:"hidden md:flex items-center gap-2",children:[(0,n.jsx)(c.Z,{className:"w-4 h-4"}),"戻る"]})]}),(0,n.jsxs)("div",{className:"w-full mb-32",children:[(0,n.jsx)("div",{className:"bg-gray-200 rounded-full h-3 shadow-inner",children:(0,n.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-3 rounded-full transition-all duration-500 shadow-sm",style:{width:"".concat(h/s.length*100,"%")}})}),(0,n.jsx)("div",{className:"text-center mt-6",children:(0,n.jsxs)("span",{className:"text-sm text-gray-600",children:[h," / ",s.length," 完了"]})})]}),(0,n.jsx)("div",{className:"flex justify-center mt-8",children:(0,n.jsxs)("div",{className:"relative w-full max-w-md",children:[h+1<s.length&&(0,n.jsx)(l.Zb,{className:"absolute inset-0 transform scale-95 opacity-30 z-0 bg-gray-50",children:(0,n.jsx)(l.aY,{className:"p-6",children:(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)("div",{className:"text-gray-400 text-sm",children:"次の取引"})})})}),(0,n.jsxs)(l.Zb,{ref:R,className:"relative z-10 transform transition-transform duration-200 ".concat("left"===j?"bg-green-50 border-green-200":"right"===j?"bg-purple-50 border-purple-200":"bg-white"),style:{transform:"translate(".concat(b.x,"px, ").concat(b.y,"px) rotate(").concat(b.x/10,"deg)"),cursor:g?"grabbing":"grab"},onTouchStart:e=>{if(C)return;v(!0);let t=e.touches[0];k({x:t.clientX,y:t.clientY})},onTouchMove:e=>{if(!g||C)return;let t=e.touches[0],r=t.clientX-w.x;y({x:r,y:t.clientY-w.y}),Math.abs(r)>50?N(r>0?"right":"left"):N(null)},onTouchEnd:()=>{g&&!C&&(Math.abs(b.x)>120?D(b.x>0?"right":"left"):_())},onMouseDown:e=>{C||(v(!0),k({x:e.clientX,y:e.clientY}))},onMouseMove:g?e=>{if(!g||C)return;let t=e.clientX-w.x;y({x:t,y:e.clientY-w.y}),Math.abs(t)>50?N(t>0?"right":"left"):N(null)}:void 0,onMouseUp:I,onMouseLeave:I,children:[(0,n.jsx)(l.Ol,{className:"pb-3",children:(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(l.ll,{className:"text-lg font-bold text-gray-900",children:O.memo||O.originalDescription}),(0,n.jsx)(l.SZ,{className:"text-sm text-gray-600 mt-1",children:(0,o.o0)(O.eventAt)})]}),(0,n.jsx)("div",{className:"text-right",children:(0,n.jsxs)("div",{className:"text-2xl font-bold ".concat("out"===O.sign?"text-red-600":"text-green-600"),children:["out"===O.sign?"-":"+",(0,o.xG)(O.amount)]})})]})}),(0,n.jsx)(l.aY,{className:"pt-0",children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,n.jsx)("strong",{children:"取引内容:"})," ",O.originalDescription]}),(0,n.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 border-2 border-dashed border-gray-200",children:(0,n.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,n.jsx)(c.Z,{className:"w-4 h-4"}),(0,n.jsx)("span",{className:"font-medium",children:"生活口座"})]}),(0,n.jsx)("div",{className:"text-gray-500 font-medium",children:"スワイプで選択"}),(0,n.jsxs)("div",{className:"flex items-center gap-2 text-purple-600",children:[(0,n.jsx)("span",{className:"font-medium",children:"推し活口座"}),(0,n.jsx)(u.Z,{className:"w-4 h-4"})]})]})}),j&&(0,n.jsx)("div",{className:"text-center py-2 rounded-lg font-medium ".concat("left"===j?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"),children:"left"===j?"← 生活口座に振り分け":"推し活口座に振り分け →"})]})})]}),A&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-20 bg-white/90 rounded-lg",children:(0,n.jsxs)("div",{className:"text-center ".concat("left"===E?"text-green-600":"text-purple-600"),children:[(0,n.jsx)("div",{className:"text-4xl mb-2",children:"left"===E?"✓":"\uD83D\uDC9C"}),(0,n.jsx)("div",{className:"font-bold text-lg",children:"left"===E?"生活口座":"推し活口座"}),(0,n.jsx)("div",{className:"text-sm",children:"振り分け完了"})]})})]})}),(0,n.jsxs)("div",{className:"text-center space-y-4",children:[(0,n.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-medium mb-2",children:[(0,n.jsx)(d,{className:"w-5 h-5"}),(0,n.jsx)("span",{children:"操作方法"})]}),(0,n.jsxs)("div",{className:"text-sm text-blue-600 space-y-1",children:[(0,n.jsxs)("p",{children:["• カードを",(0,n.jsx)("strong",{children:"左にスワイプ"}),"で生活口座"]}),(0,n.jsxs)("p",{children:["• カードを",(0,n.jsx)("strong",{children:"右にスワイプ"}),"で推し活口座"]}),(0,n.jsx)("p",{children:"• または下のボタンでも操作できます"})]})]}),(0,n.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-100",children:[(0,n.jsx)("p",{className:"text-center text-gray-600 mb-4 font-medium",children:"または、ボタンで操作することもできます"}),(0,n.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,n.jsxs)("button",{onClick:()=>D("left"),className:"px-8 py-3 rounded-2xl font-semibold transition-all duration-300 ".concat(C?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-green-500 to-green-600 text-white shadow-lg shadow-green-500/30 hover:shadow-xl hover:shadow-green-500/40 hover:scale-105 active:scale-95"," flex items-center gap-3"),disabled:C,children:[(0,n.jsx)(c.Z,{className:"w-5 h-5"}),"生活口座"]}),(0,n.jsxs)("button",{onClick:()=>D("right"),className:"px-8 py-3 rounded-2xl font-semibold transition-all duration-300 ".concat(C?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-purple-500 to-purple-600 text-white shadow-lg shadow-purple-500/30 hover:shadow-xl hover:shadow-purple-500/40 hover:scale-105 active:scale-95"," flex items-center gap-3"),disabled:C,children:["推し活口座",(0,n.jsx)(u.Z,{className:"w-5 h-5"})]})]})]})]})]})}function h(){let e=(0,s.useRouter)();return(0,n.jsx)(m,{onBack:()=>{e.push("/transactions")},onUpdate:()=>{e.refresh()}})}},7839:function(e,t,r){"use strict";r.d(t,{z:function(){return c}});var n=r(9075),a=r(511),s=r(5384),l=r(3452),i=r(9042);let o=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-medium transition-all duration-200 ease-in-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-300 focus-visible:ring-opacity-50 disabled:pointer-events-none disabled:opacity-50 touch-target",{variants:{variant:{default:"bg-primary-400 text-neutral-800 hover:bg-primary-500 active:bg-primary-600 shadow-normal hover:shadow-strong",destructive:"bg-error-500 text-white hover:bg-error-600 active:bg-error-700 shadow-normal hover:shadow-strong",outline:"border-2 border-primary-300 bg-transparent text-primary-600 hover:bg-primary-50 hover:border-primary-400 active:bg-primary-100",secondary:"bg-neutral-100 text-neutral-700 hover:bg-neutral-200 active:bg-neutral-300 shadow-soft hover:shadow-normal",ghost:"bg-transparent text-neutral-600 hover:bg-neutral-50 hover:text-neutral-700 active:bg-neutral-100",link:"text-primary-600 underline-offset-4 hover:underline hover:text-primary-700",success:"bg-success-500 text-white hover:bg-success-600 active:bg-success-700 shadow-normal hover:shadow-strong",warning:"bg-warning-500 text-white hover:bg-warning-600 active:bg-warning-700 shadow-normal hover:shadow-strong"},size:{default:"h-11 px-4 py-2 md:px-6 md:py-3",sm:"h-9 px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm",lg:"h-12 px-6 py-3 md:px-8 md:py-4 text-base md:text-lg",icon:"h-11 w-11 p-0"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,size:l,asChild:c=!1,...d}=e,u=c?s.g7:"button";return(0,n.jsx)(u,{className:(0,i.cn)(o({variant:a,size:l,className:r})),ref:t,...d})});c.displayName="Button"},1438:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return l},aY:function(){return d},ll:function(){return o}});var n=r(9075),a=r(511),s=r(9042);let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("rounded-xl md:rounded-2xl border border-neutral-200 bg-white shadow-normal hover:shadow-strong transition-all duration-200 ease-in-out",r),...a})});l.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-4 md:p-6",r),...a})});i.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("h3",{ref:t,className:(0,s.cn)("heading-3",r),...a})});o.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("p",{ref:t,className:(0,s.cn)("body-medium text-neutral-500",r),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("p-4 md:p-6 pt-0",r),...a})});d.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-4 md:p-6 pt-0",r),...a})}).displayName="CardFooter"},9042:function(e,t,r){"use strict";r.d(t,{cn:function(){return s},o0:function(){return i},xG:function(){return l}});var n=r(8273),a=r(868);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,n.W)(t))}function l(e){let t=isNaN(e)||null==e?0:e,r=new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY"}).format(Math.abs(t));return t<0?"￥-".concat(r.slice(1)):r}function i(e){return new Intl.DateTimeFormat("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(e)}},9804:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var n=r(511),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),l=(e,t)=>{let r=(0,n.forwardRef)((r,l)=>{let{color:i="currentColor",size:o=24,strokeWidth:c=2,absoluteStrokeWidth:d,className:u="",children:m,...h}=r;return(0,n.createElement)("svg",{ref:l,...a,width:o,height:o,stroke:i,strokeWidth:d?24*Number(c)/Number(o):c,className:["lucide","lucide-".concat(s(e)),u].join(" "),...h},[...t.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(m)?m:[m]])});return r.displayName="".concat(e),r}},9627:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(9804).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},3942:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(9804).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},4991:function(e,t,r){"use strict";r.d(t,{F:function(){return s},e:function(){return l}});var n=r(511);function a(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>{let r=!1,n=t.map(t=>{let n=a(t,e);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let e=0;e<n.length;e++){let r=n[e];"function"==typeof r?r():a(t[e],null)}}}}function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.useCallback(s(...t),t)}},5384:function(e,t,r){"use strict";r.d(t,{Z8:function(){return l},g7:function(){return i}});var n=r(511),a=r(4991),s=r(9075);function l(e){let t=function(e){let t=n.forwardRef((e,t)=>{let{children:r,...s}=e;if(n.isValidElement(r)){var l,i;let e,o;let c=(e=null===(l=Object.getOwnPropertyDescriptor(r.props,"ref"))||void 0===l?void 0:l.get)&&"isReactWarning"in e&&e.isReactWarning?r.ref:(e=null===(i=Object.getOwnPropertyDescriptor(r,"ref"))||void 0===i?void 0:i.get)&&"isReactWarning"in e&&e.isReactWarning?r.props.ref:r.props.ref||r.ref,d=function(e,t){let r={...t};for(let n in t){let a=e[n],s=t[n];/^on[A-Z]/.test(n)?a&&s?r[n]=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=s(...t);return a(...t),n}:a&&(r[n]=a):"style"===n?r[n]={...a,...s}:"className"===n&&(r[n]=[a,s].filter(Boolean).join(" "))}return{...e,...r}}(s,r.props);return r.type!==n.Fragment&&(d.ref=t?(0,a.F)(t,c):c),n.cloneElement(r,d)}return n.Children.count(r)>1?n.Children.only(null):null});return t.displayName="".concat(e,".SlotClone"),t}(e),r=n.forwardRef((e,r)=>{let{children:a,...l}=e,i=n.Children.toArray(a),o=i.find(c);if(o){let e=o.props.children,a=i.map(t=>t!==o?t:n.Children.count(e)>1?n.Children.only(null):n.isValidElement(e)?e.props.children:null);return(0,s.jsx)(t,{...l,ref:r,children:n.isValidElement(e)?n.cloneElement(e,void 0,a):null})}return(0,s.jsx)(t,{...l,ref:r,children:a})});return r.displayName="".concat(e,".Slot"),r}var i=l("Slot"),o=Symbol("radix.slottable");function c(e){return n.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===o}},3452:function(e,t,r){"use strict";r.d(t,{j:function(){return l}});var n=r(8273);let a=e=>"boolean"==typeof e?"".concat(e):0===e?"0":e,s=n.W,l=(e,t)=>r=>{var n;if((null==t?void 0:t.variants)==null)return s(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:l,defaultVariants:i}=t,o=Object.keys(l).map(e=>{let t=null==r?void 0:r[e],n=null==i?void 0:i[e];if(null===t)return null;let s=a(t)||a(n);return l[e][s]}),c=r&&Object.entries(r).reduce((e,t)=>{let[r,n]=t;return void 0===n||(e[r]=n),e},{});return s(e,o,null==t?void 0:null===(n=t.compoundVariants)||void 0===n?void 0:n.reduce((e,t)=>{let{class:r,className:n,...a}=t;return Object.entries(a).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...i,...c}[t]):({...i,...c})[t]===r})?[...e,r,n]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}}},function(e){e.O(0,[682,852,999,744],function(){return e(e.s=7947)}),_N_E=e.O()}]);