(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4861:function(e,s,t){Promise.resolve().then(t.bind(t,8352))},8352:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return C}});var a=t(9075),l=t(511),n=t(8273),r=t(868);function i(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.m6)((0,n.W)(s))}function c(e){return new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY"}).format(e)}let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:i("rounded-lg border bg-card text-card-foreground shadow-sm",t),...l})});d.displayName="Card";let o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:i("flex flex-col space-y-1.5 p-6",t),...l})});o.displayName="CardHeader";let m=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("h3",{ref:s,className:i("text-2xl font-semibold leading-none tracking-tight",t),...l})});m.displayName="CardTitle";let u=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("p",{ref:s,className:i("text-sm text-muted-foreground",t),...l})});u.displayName="CardDescription";let x=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:i("p-6 pt-0",t),...l})});x.displayName="CardContent",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:i("flex items-center p-6 pt-0",t),...l})}).displayName="CardFooter";var h=t(9483);let f=(0,t(3452).j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",oshi:"oshi-gradient text-white hover:opacity-90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),p=l.forwardRef((e,s)=>{let{className:t,variant:l,size:n,asChild:r=!1,...c}=e,d=r?h.g7:"button";return(0,a.jsx)(d,{className:i(f({variant:l,size:n,className:t})),ref:s,...c})});function j(e){let{account:s,transactions:t,onClose:l}=e,n=t.filter(e=>"life"===s.kind&&"ticket"!==e.purpose&&"goods"!==e.purpose&&"event"!==e.purpose||"oshi"===s.kind&&("ticket"===e.purpose||"goods"===e.purpose||"event"===e.purpose)),r=n.filter(e=>"in"===e.sign).reduce((e,s)=>e+s.amount,0),i=n.filter(e=>"out"===e.sign).reduce((e,s)=>e+s.amount,0);return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(d,{className:"w-full max-w-2xl max-h-[80vh] overflow-hidden",children:[(0,a.jsx)(o,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(m,{children:[s.name,"詳細"]}),(0,a.jsxs)(u,{children:["残高: ",c(s.balanceCached)]})]}),(0,a.jsx)(p,{variant:"ghost",onClick:l,children:"✕"})]})}),(0,a.jsxs)(x,{className:"overflow-y-auto",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"p-4 bg-green-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-green-600",children:"総収入"}),(0,a.jsx)("p",{className:"text-xl font-bold text-green-700",children:c(r)})]}),(0,a.jsxs)("div",{className:"p-4 bg-red-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-red-600",children:"総支出"}),(0,a.jsx)("p",{className:"text-xl font-bold text-red-700",children:c(i)})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-3",children:"取引履歴"}),(0,a.jsx)("div",{className:"space-y-2",children:0===n.length?(0,a.jsx)("p",{className:"text-muted-foreground text-center py-4",children:"取引履歴がありません"}):n.sort((e,s)=>new Date(s.eventAt).getTime()-new Date(e.eventAt).getTime()).map(e=>{var s;return(0,a.jsx)("div",{className:"p-3 rounded-lg border ".concat(e.isPending?"bg-yellow-50 border-yellow-200":e.isAutoCategorized?"bg-green-50 border-green-200":"bg-gray-50"),children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"font-medium",children:e.memo}),e.isAutoCategorized&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded-full",children:"自動分類"}),e.isPending&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-yellow-100 text-yellow-700 rounded-full",children:"保留中"})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(s=e.eventAt,new Intl.DateTimeFormat("ja-JP",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(s))," • ",e.purpose]})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsxs)("p",{className:"font-medium ".concat("out"===e.sign?"text-red-600":"text-green-600"),children:["out"===e.sign?"-":"+",c(e.amount)]})})]})},e.id)})})]})]})]})})}p.displayName="Button";let g=[{value:"salary",label:"給与・収入"},{value:"ticket",label:"チケット"},{value:"goods",label:"グッズ"},{value:"event",label:"イベント"},{value:"food",label:"食費"},{value:"rent",label:"家賃・住居費"},{value:"utilities",label:"光熱費・通信費"},{value:"transport",label:"交通費"},{value:"other",label:"その他"}],v=[{value:"life",label:"生活口座"},{value:"oshi",label:"推し活口座"}];function N(e){var s;let{transaction:t,onSave:n,onClose:r}=e,[i,h]=(0,l.useState)({...t}),[f,j]=(0,l.useState)(["ticket","goods","event"].includes(t.purpose)?"oshi":"life");return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(d,{className:"w-full max-w-md",children:[(0,a.jsx)(o,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(m,{children:"取引を編集"}),(0,a.jsxs)(u,{children:[c(t.amount)," • ",t.eventAt.toLocaleDateString("ja-JP")]})]}),(0,a.jsx)(p,{variant:"ghost",onClick:r,children:"✕"})]})}),(0,a.jsxs)(x,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"元の摘要"}),(0,a.jsx)("p",{className:"p-2 bg-gray-50 rounded text-sm",children:t.originalDescription||t.memo})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"メモ"}),(0,a.jsx)("input",{type:"text",value:i.memo,onChange:e=>h({...i,memo:e.target.value}),className:"w-full p-2 border rounded mt-1",placeholder:"メモを入力"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"口座種別"}),(0,a.jsx)("select",{value:f,onChange:e=>j(e.target.value),className:"w-full p-2 border rounded mt-1",children:v.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"用途"}),(0,a.jsx)("select",{value:i.purpose,onChange:e=>h({...i,purpose:e.target.value}),className:"w-full p-2 border rounded mt-1",children:g.filter(e=>"oshi"===f?["ticket","goods","event","other"].includes(e.value):!["ticket","goods","event"].includes(e.value)).map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsx)("div",{className:"p-3 bg-blue-50 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-blue-700",children:[(0,a.jsx)("strong",{children:"編集後:"})," ","life"===f?"生活口座":"推し活口座"," • ",null===(s=g.find(e=>e.value===i.purpose))||void 0===s?void 0:s.label]})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(p,{variant:"outline",onClick:r,className:"flex-1",children:"キャンセル"}),(0,a.jsx)(p,{onClick:()=>{let e=i.purpose;"oshi"!==f||["ticket","goods","event"].includes(e)||(e="other"),n({...i,purpose:e,isAutoCategorized:!1,isPending:!1}),r()},className:"flex-1",children:"保存"})]})]})]})})}let b={user:{id:"user_10000001",email:"customer1@oshieru.com",displayName:"顧客1",createdAt:new Date("2024-01-01")},accounts:[{id:"acc_life_10000001",userId:"user_10000001",kind:"life",name:"生活口座",balanceCached:38e4,createdAt:new Date("2024-01-01")},{id:"acc_oshi_10000001",userId:"user_10000001",kind:"oshi",name:"推し活口座",balanceCached:0,createdAt:new Date("2024-01-01")}],latestScore:{id:"score_1",userId:"user_10000001",score:65,label:"安心",snapshotAt:new Date("2024-07-31"),factors:{incomeRatioScore:30,surplusScore:25,recommendedAmountScore:10,incomeRatio:15,surplusRatio:.8,recommendedDeviation:20}},recentTransactions:[{id:"tx_recent_1",accountId:"acc_life_10000001",amount:38e4,sign:"in",purpose:"salary",memo:"給与振込",originalDescription:"給与振込",isAutoCategorized:!0,isPending:!1,canEdit:!0,eventAt:new Date("2024-06-25"),accountName:"生活口座",accountKind:"life"},{id:"tx_recent_2",accountId:"acc_life_10000001",amount:9e3,sign:"out",purpose:"other",memo:"クレジットカード",originalDescription:"クレジットカード",isAutoCategorized:!1,isPending:!0,canEdit:!0,eventAt:new Date("2024-06-10"),accountName:"生活口座",accountKind:"life"}],availableRewards:[{id:"reward_2",slug:"exclusive-shop",title:"限定オンラインショップ",description:"推し活安心度スコア60点以上で利用可能。限定グッズを優先購入できます。",minScore:60,active:!0},{id:"reward_3",slug:"storage-service",title:"荷物預かりサービス",description:"推し活安心度スコア40点以上で利用可能。イベント時の荷物を無料で預かります。",minScore:40,active:!0}]};function y(e){var s;let{onLogout:t}=e,[n,r]=(0,l.useState)(b),[i,h]=(0,l.useState)(!0),[f,g]=(0,l.useState)(null),[v,y]=(0,l.useState)(null),[w,S]=(0,l.useState)(null),C=e=>{let s=[{id:"tx_".concat(e.id,"_salary"),accountId:"acc_life_".concat(e.id.split("_")[1]),amount:e.id.includes("10000001")?38e4:e.id.includes("10000002")?777777:15e4,sign:"in",purpose:"salary",memo:"給与振込",originalDescription:"給与振込",isAutoCategorized:!0,isPending:!1,canEdit:!0,eventAt:new Date("2024-06-25"),accountName:"生活口座",accountKind:"life"},{id:"tx_".concat(e.id,"_credit"),accountId:"acc_life_".concat(e.id.split("_")[1]),amount:e.id.includes("10000001")?9e3:e.id.includes("10000002")?6e3:3e3,sign:"out",purpose:"other",memo:"クレジットカード",originalDescription:"クレジットカード",isAutoCategorized:!1,isPending:!0,canEdit:!0,eventAt:new Date("2024-06-10"),accountName:"生活口座",accountKind:"life"}];return e.id.includes("10000003")&&s.push({id:"tx_".concat(e.id,"_small1"),accountId:"acc_life_".concat(e.id.split("_")[1]),amount:2400,sign:"in",purpose:"other",memo:"振込",originalDescription:"振込",isAutoCategorized:!1,isPending:!0,canEdit:!0,eventAt:new Date("2024-06-03"),accountName:"生活口座",accountKind:"life"}),s};(0,l.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("currentUser");if(e){let s=JSON.parse(e);S(s);let t=C(s);r(e=>({...e,user:{id:s.id,email:s.email,displayName:s.displayName,createdAt:new Date("2024-01-01")},accounts:[{id:"acc_life_".concat(s.id.split("_")[1]),userId:s.id,kind:"life",name:"生活口座",balanceCached:s.lifeBalance,createdAt:new Date("2024-01-01")},{id:"acc_oshi_".concat(s.id.split("_")[1]),userId:s.id,kind:"oshi",name:"推し活口座",balanceCached:s.oshiBalance,createdAt:new Date("2024-01-01")}],latestScore:{...e.latestScore,userId:s.id,score:s.id.includes("10000001")?60:s.id.includes("10000002")?70:80,label:s.id.includes("10000001")?"安心":s.id.includes("10000002")?"安心":"とても安心"},recentTransactions:t}))}}catch(e){console.error("Failed to load user data:",e)}finally{h(!1)}})()},[]);let _=n.accounts.find(e=>"life"===e.kind),D=n.accounts.find(e=>"oshi"===e.kind);return i?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"ダッシュボードを読み込み中..."})]})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold",children:["こんにちは、",n.user.displayName,"さん"]}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"今日も健康的な推し活を楽しみましょう！"})]}),(0,a.jsx)(p,{variant:"outline",onClick:()=>{localStorage.removeItem("sessionId"),localStorage.removeItem("userEmail"),localStorage.removeItem("currentUser"),t?t():window.location.reload()},children:"ログアウト"})]}),n.latestScore&&(0,a.jsxs)(d,{className:"oshi-card ".concat((s=n.latestScore.score)>=80?"safety-score-excellent":s>=60?"safety-score-good":s>=40?"safety-score-warning":"safety-score-danger"),children:[(0,a.jsxs)(o,{children:[(0,a.jsxs)(m,{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"推し活安心度スコア"}),(0,a.jsxs)("span",{className:"text-3xl font-bold",children:[n.latestScore.score,"点"]})]}),(0,a.jsxs)(u,{children:["現在のステータス: ",(0,a.jsx)("strong",{children:n.latestScore.label})]})]}),(0,a.jsx)(x,{children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"収入比率"}),(0,a.jsxs)("p",{children:[n.latestScore.factors.incomeRatio.toFixed(1),"%"]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[n.latestScore.factors.incomeRatioScore,"点"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"余剰金比率"}),(0,a.jsx)("p",{children:n.latestScore.factors.surplusRatio.toFixed(2)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[n.latestScore.factors.surplusScore,"点"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"推奨額適合"}),(0,a.jsxs)("p",{children:[n.latestScore.factors.recommendedDeviation.toFixed(1),"%"]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[n.latestScore.factors.recommendedAmountScore,"点"]})]})]})})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[_&&(0,a.jsx)(d,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>g(_),children:(0,a.jsxs)(o,{children:[(0,a.jsxs)(m,{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{children:["\uD83D\uDCB0 ",_.name]}),(0,a.jsx)("span",{className:"text-lg",children:c(_.balanceCached)})]}),(0,a.jsx)(u,{children:"日常の収入・支出を管理"}),(0,a.jsx)("p",{className:"text-xs text-blue-600 mt-2",children:"\uD83D\uDCCA 詳細を見る"})]})}),D&&(0,a.jsx)(d,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>g(D),children:(0,a.jsxs)(o,{children:[(0,a.jsxs)(m,{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{children:["✨ ",D.name]}),(0,a.jsx)("span",{className:"text-lg",children:c(D.balanceCached)})]}),(0,a.jsx)(u,{children:"推し活専用の予算管理"}),(0,a.jsx)("p",{className:"text-xs text-blue-600 mt-2",children:"\uD83D\uDCCA 詳細を見る"})]})})]}),(0,a.jsxs)(d,{children:[(0,a.jsxs)(o,{children:[(0,a.jsx)(m,{children:"\uD83D\uDCCA 最近の取引"}),(0,a.jsx)(u,{children:"自動振り分けと保留中の取引"})]}),(0,a.jsxs)(x,{children:[(0,a.jsx)("div",{className:"space-y-3",children:n.recentTransactions.map(e=>(0,a.jsx)("div",{className:"p-3 rounded-lg border ".concat(e.isPending?"bg-yellow-50 border-yellow-200":e.isAutoCategorized?"bg-green-50 border-green-200":"bg-muted/50"),children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"font-medium",children:e.memo}),e.isAutoCategorized&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded-full",children:"自動振り分け済み"}),e.isPending&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-yellow-100 text-yellow-700 rounded-full",children:"保留中"})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.eventAt.toLocaleDateString("ja-JP")," • ",e.accountName]}),e.isPending&&(0,a.jsx)("p",{className:"text-xs text-orange-600 mt-1",children:"⚠️ 用途の手動振り分けが必要です"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-medium ".concat("out"===e.sign?"text-red-600":"text-green-600"),children:["out"===e.sign?"-":"+",c(e.amount)]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.purpose}),e.canEdit&&(0,a.jsx)(p,{variant:"ghost",size:"sm",className:"mt-1 h-6 text-xs",onClick:s=>{s.stopPropagation(),y(e)},children:"編集"})]})]})},e.id))}),n.recentTransactions.some(e=>e.isPending)&&(0,a.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-blue-700",children:["\uD83D\uDCA1 ",(0,a.jsx)("strong",{children:"保留中の取引があります"}),(0,a.jsx)("br",{}),"クレジットカードや振込などの取引は、用途を手動で設定してください。 正確な振り分けにより、より精密な推し活安心度スコアが算出されます。"]})})]})]}),(0,a.jsxs)(d,{children:[(0,a.jsxs)(o,{children:[(0,a.jsx)(m,{children:"\uD83C\uDF81 利用可能な特典"}),(0,a.jsx)(u,{children:"あなたのスコアで利用できる特典"})]}),(0,a.jsx)(x,{children:(0,a.jsx)("div",{className:"grid gap-4",children:n.availableRewards.filter(e=>n.latestScore&&n.latestScore.score>=e.minScore).map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 rounded-lg border",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]}),(0,a.jsx)(p,{variant:"outline",size:"sm",children:"利用する"})]},e.id))})})]}),f&&(0,a.jsx)(j,{account:f,transactions:n.recentTransactions,onClose:()=>g(null)}),v&&(0,a.jsx)(N,{transaction:v,onSave:e=>{r(s=>({...s,recentTransactions:s.recentTransactions.map(s=>s.id===e.id?e:s)})),console.log("Transaction updated:",e)},onClose:()=>y(null)})]})}function w(e){let{onLoginSuccess:s}=e,[t,n]=(0,l.useState)(""),[r,i]=(0,l.useState)(!1),[h,f]=(0,l.useState)([]),[j,g]=(0,l.useState)(!0);(0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat("https://oshieru-api.harukana1435.workers.dev","/users/demo"));if(e.ok){let s=await e.json();s.success&&f(s.users)}}catch(e){console.error("Failed to fetch demo users:",e),f([{id:"user_10000001",email:"customer1@oshieru.com",displayName:"顧客1",lifeBalance:38e4,oshiBalance:0,totalBalance:38e4},{id:"user_10000002",email:"customer2@oshieru.com",displayName:"顧客2",lifeBalance:1399999,oshiBalance:0,totalBalance:1399999},{id:"user_10000003",email:"customer3@oshieru.com",displayName:"顧客3",lifeBalance:230,oshiBalance:0,totalBalance:230}])}finally{g(!1)}})()},[]);let v=async e=>{if(e.preventDefault(),t){i(!0);try{let e="demo-session-"+Date.now();localStorage.setItem("sessionId",e),localStorage.setItem("userEmail",t),s?s():window.location.reload()}catch(e){console.error("Login failed:",e)}finally{i(!1)}}},N=e=>{localStorage.removeItem("sessionId"),localStorage.removeItem("userEmail"),localStorage.removeItem("currentUser");let s=h.find(s=>s.email===e);s&&localStorage.setItem("currentUser",JSON.stringify(s)),n(e),setTimeout(()=>{let e=document.querySelector("form");null==e||e.requestSubmit()},100)};return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,a.jsxs)(d,{className:"w-full max-w-md",children:[(0,a.jsxs)(o,{className:"text-center",children:[(0,a.jsx)(m,{className:"text-2xl",children:"ログイン"}),(0,a.jsx)(u,{children:"推しエール口座にアクセスするためにメールアドレスを入力してください"})]}),(0,a.jsxs)(x,{children:[(0,a.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium mb-2",children:"メールアドレス"}),(0,a.jsx)("input",{id:"email",type:"email",value:t,onChange:e=>n(e.target.value),className:"w-full px-3 py-2 border border-input rounded-md bg-background",placeholder:"your-email@example.com",required:!0})]}),(0,a.jsx)(p,{type:"submit",className:"w-full",variant:"oshi",disabled:r||!t,children:r?"処理中...":"ログイン"})]}),(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,a.jsx)("p",{className:"text-sm font-medium mb-2",children:"デモアカウント"}),(0,a.jsx)("div",{className:"space-y-2",children:j?(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"残高情報を読み込み中..."})}):h.map((e,s)=>(0,a.jsx)(p,{onClick:()=>N(e.email),variant:"outline",className:"w-full text-left justify-start",children:(0,a.jsxs)("div",{className:"flex flex-col items-start",children:[(0,a.jsx)("span",{className:"font-medium",children:e.displayName}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["総残高: ",c(e.totalBalance),e.lifeBalance>0&&e.oshiBalance>0&&(0,a.jsxs)("span",{className:"ml-1",children:["(生活: ",c(e.lifeBalance),", 推し活: ",c(e.oshiBalance),")"]})]})]})},e.id))}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground text-center mt-2",children:"実際のデータベースから取得した顧客データを体験できます"})]})]})]})})}function S(){return(0,a.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,a.jsx)(d,{className:"w-full max-w-md",children:(0,a.jsx)(x,{className:"flex items-center justify-center p-8",children:(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"読み込み中..."})]})})})})}function C(){return(0,a.jsxs)("main",{className:"container mx-auto py-6",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold oshi-gradient bg-clip-text text-transparent mb-2",children:"推しエール口座"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"健康的に推し活を続けるための口座管理"})]}),(0,a.jsx)(l.Suspense,{fallback:(0,a.jsx)(S,{}),children:(0,a.jsx)(_,{})})]})}function _(){let[e,s]=(0,l.useState)(null),[t,n]=(0,l.useState)(!0);return((0,l.useEffect)(()=>{let e=()=>{s(!!localStorage.getItem("sessionId")),n(!1)};e();let t=()=>{e()};return window.addEventListener("storage",t),()=>{window.removeEventListener("storage",t)}},[]),t)?(0,a.jsx)(S,{}):e?(0,a.jsx)(y,{onLogout:()=>s(!1)}):(0,a.jsx)(w,{onLoginSuccess:()=>s(!0)})}}},function(e){e.O(0,[593,852,999,744],function(){return e(e.s=4861)}),_N_E=e.O()}]);